<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>$ELK Mountain Ascent ‚Äî Climb the Summit of Consciousness</title>
<meta name="description" content="A philosophical mountain climbing quiz game. Guide the elk from base camp to the summit by answering questions inspired by existential philosophy.">
<meta property="og:title" content="$ELK Mountain Ascent">
<meta property="og:description" content="Carry the antlers to the summit. A philosophical climbing game.">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#050508;
  --mountain-dark:#0d1117;
  --mountain-mid:#141e2a;
  --mountain-light:#1a2634;
  --green-deep:#0f2918;
  --green-mid:#1a3d24;
  --purple-deep:#1a0f2e;
  --purple-mid:#2d1b4e;
  --fog:#8899aa;
  --gold:#d4a843;
  --gold-bright:#f0c75e;
  --campfire:#e8712a;
  --campfire-glow:rgba(232,113,42,0.3);
  --text-primary:rgba(255,255,255,0.9);
  --text-secondary:rgba(255,255,255,0.6);
  --text-dim:rgba(255,255,255,0.35);
  --glass:rgba(255,255,255,0.05);
  --glass-border:rgba(255,255,255,0.08);
}
html,body{
  width:100%;height:100%;overflow:hidden;
  font-family:'Crimson Text',Georgia,serif;
  background:var(--bg);color:var(--text-primary);
}
body{display:flex;flex-direction:column;position:relative}

/* ‚îÄ‚îÄ Mountain Scene ‚îÄ‚îÄ */
.scene{position:relative;flex:1;overflow:hidden;min-height:0}

/* Sky gradient ‚Äî transitions through elevation */
.sky{
  position:absolute;inset:0;
  background:linear-gradient(180deg,#030308 0%,#060812 20%,#0a0e1e 45%,#0e1528 70%,#111d30 100%);
  transition:background 2.5s ease;
}
.sky.mid{
  background:linear-gradient(180deg,#020206 0%,#040610 20%,#070a1a 50%,#0a1020 100%);
}
.sky.high{
  background:linear-gradient(180deg,#010104 0%,#030308 15%,#050710 40%,#070a16 100%);
}

/* Stars */
.stars{position:absolute;inset:0;opacity:0;transition:opacity 3s ease}
.stars.dim{opacity:0.4}
.stars.visible{opacity:1}
.star{
  position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;
  animation:twinkle var(--d,3s) ease-in-out infinite alternate;
  opacity:var(--o,0.6);
}
@keyframes twinkle{0%{opacity:var(--o,0.4);transform:scale(1)}100%{opacity:1;transform:scale(1.3)}}

/* Shooting stars */
.shooting-star{
  position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;
  opacity:0;z-index:4;
}
.shooting-star.active{
  animation:shoot var(--dur,1.2s) linear forwards;
}
@keyframes shoot{
  0%{opacity:0;transform:translate(0,0);box-shadow:0 0 2px #fff,0 0 6px rgba(180,200,255,0.5)}
  10%{opacity:1}
  90%{opacity:0.8}
  100%{opacity:0;transform:translate(var(--dx,-200px),var(--dy,120px));box-shadow:none}
}

/* Aurora borealis */
.aurora{
  position:absolute;top:0;left:0;right:0;height:40%;
  opacity:0;transition:opacity 4s ease;
  pointer-events:none;z-index:1;
  overflow:hidden;
}
.aurora.visible{opacity:1}
.aurora-band{
  position:absolute;width:200%;left:-50%;
  height:60px;
  border-radius:50%;
  filter:blur(30px);
  opacity:0.15;
  animation:aurora-wave var(--speed,12s) ease-in-out infinite alternate;
}
.aurora-band:nth-child(1){
  top:15%;background:linear-gradient(90deg,transparent,#1a6b4a,#2dd47b,#1a6b4a,transparent);
  --speed:14s;
}
.aurora-band:nth-child(2){
  top:22%;background:linear-gradient(90deg,transparent,#1a4a6b,#2db4d4,#1a4a6b,transparent);
  --speed:18s;animation-direction:alternate-reverse;
}
.aurora-band:nth-child(3){
  top:10%;background:linear-gradient(90deg,transparent,#4a1a6b,#8b2dd4,#4a1a6b,transparent);
  --speed:22s;opacity:0.08;
}
@keyframes aurora-wave{
  0%{transform:translateX(-15%) scaleY(1)}
  50%{transform:translateX(10%) scaleY(1.5)}
  100%{transform:translateX(-5%) scaleY(0.8)}
}

/* Wind particles */
.wind-particles{
  position:absolute;inset:0;pointer-events:none;z-index:7;
  opacity:0;transition:opacity 2s ease;
}
.wind-particles.visible{opacity:1}
.wind-particle{
  position:absolute;width:var(--w,20px);height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,var(--o,0.08)),transparent);
  animation:wind var(--speed,6s) linear infinite;
  animation-delay:var(--delay,0s);
}
@keyframes wind{
  0%{transform:translateX(-100px);opacity:0}
  20%{opacity:1}
  80%{opacity:1}
  100%{transform:translateX(calc(100vw + 100px));opacity:0}
}

/* Snow particles (high altitude) */
.snow-particles{
  position:absolute;top:0;left:0;right:0;height:50%;
  pointer-events:none;z-index:7;
  opacity:0;transition:opacity 3s ease;
}
.snow-particles.visible{opacity:1}
.snow-p{
  position:absolute;width:var(--s,2px);height:var(--s,2px);
  background:rgba(255,255,255,var(--o,0.3));border-radius:50%;
  animation:snowfall var(--dur,8s) linear infinite;
  animation-delay:var(--delay,0s);
}
@keyframes snowfall{
  0%{transform:translate(0,-10px);opacity:0}
  10%{opacity:1}
  90%{opacity:0.5}
  100%{transform:translate(var(--drift,20px),calc(50vh));opacity:0}
}

/* ‚îÄ‚îÄ THE MOUNTAIN ‚Äî Full-viewport layered landscape ‚îÄ‚îÄ */
.mountain-wrap{
  position:absolute;bottom:0;left:0;right:0;height:100%;
  pointer-events:none;
}

/* Main mountain SVG ‚Äî spans full width */
.mountain-svg{
  position:absolute;bottom:0;left:50%;transform:translateX(-50%);
  width:220%;height:100%;
}

/* Trail and stations */
.station{
  position:absolute;transform:translate(-50%,-50%);
  width:24px;height:24px;border-radius:50%;
  border:2px solid var(--glass-border);
  background:var(--glass);
  transition:all 0.8s ease;
  cursor:default;
  z-index:15;
}
.station.reached{
  border-color:var(--campfire);
  background:var(--campfire-glow);
  box-shadow:0 0 20px var(--campfire-glow),0 0 40px rgba(232,113,42,0.15);
}
.station.reached::after{
  content:'';position:absolute;inset:-6px;border-radius:50%;
  background:radial-gradient(circle,rgba(232,113,42,0.25) 0%,transparent 70%);
  animation:fire-pulse 2s ease-in-out infinite alternate;
}
.station.reached::before{
  content:'üî•';position:absolute;top:-16px;left:50%;transform:translateX(-50%);
  font-size:11px;
  animation:flame-flicker 0.4s ease-in-out infinite alternate;
  opacity:0.8;
}
.station.summit.reached{
  border-color:var(--gold);
  background:rgba(212,168,67,0.3);
  box-shadow:0 0 30px rgba(212,168,67,0.4),0 0 60px rgba(212,168,67,0.15);
}
.station.summit.reached::before{content:'‚≠ê';font-size:12px;top:-18px}
.station-num{
  position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:700;
  color:var(--text-dim);transition:color 0.6s;
}
.station.reached .station-num{color:var(--text-primary)}
@keyframes fire-pulse{0%{opacity:0.5;transform:scale(1)}100%{opacity:1;transform:scale(1.4)}}
@keyframes flame-flicker{0%{transform:translateX(-50%) scale(1) rotate(-3deg)}100%{transform:translateX(-50%) scale(1.1) rotate(3deg)}}

/* Trail line */
.trail-line{position:absolute;z-index:12}
.trail-line line{
  stroke:rgba(255,255,255,0.06);stroke-width:1.5;
  stroke-dasharray:4 6;
}
.trail-line line.active{
  stroke:rgba(232,113,42,0.35);
  stroke-width:2;
  filter:drop-shadow(0 0 3px rgba(232,113,42,0.3));
  transition:all 1s ease;
}

/* Elk character */
.elk{
  position:absolute;transform:translate(-50%,-50%);
  font-size:28px;z-index:16;
  transition:left 1.2s cubic-bezier(0.34,1.56,0.64,1),
             top 1.2s cubic-bezier(0.34,1.56,0.64,1);
  filter:drop-shadow(0 0 12px rgba(232,113,42,0.4));
  line-height:1;
}
.elk.idle{
  animation:elk-breathe 3s ease-in-out infinite;
}
@keyframes elk-breathe{
  0%,100%{transform:translate(-50%,-50%) scale(1)}
  50%{transform:translate(-50%,-50%) scale(1.04) translateY(-1px)}
}
.elk.slip{
  animation:slip 0.7s ease;
}
@keyframes slip{
  0%{transform:translate(-50%,-50%) rotate(0)}
  15%{transform:translate(-50%,-50%) rotate(-20deg) translateY(6px)}
  35%{transform:translate(-50%,-50%) rotate(12deg) translateY(10px)}
  60%{transform:translate(-50%,-50%) rotate(-5deg) translateY(4px)}
  100%{transform:translate(-50%,-50%) rotate(0)}
}
.elk.climb{
  animation:elk-climb 1.2s ease;
}
@keyframes elk-climb{
  0%{transform:translate(-50%,-50%) scale(1)}
  30%{transform:translate(-50%,-50%) scale(1.12) translateY(-4px)}
  60%{transform:translate(-50%,-50%) scale(1.05)}
  100%{transform:translate(-50%,-50%) scale(1)}
}
.elk.celebrate{
  animation:elk-celebrate 1s ease infinite alternate;
}
@keyframes elk-celebrate{
  0%{transform:translate(-50%,-50%) scale(1)}
  100%{transform:translate(-50%,-50%) scale(1.18) translateY(-8px)}
}

/* Fog layers */
.fog{position:absolute;bottom:0;left:0;right:0;pointer-events:none;z-index:6;transition:opacity 3s ease}
.fog-layer{
  position:absolute;bottom:0;left:-30%;width:160%;
  background:linear-gradient(180deg,transparent 0%,rgba(100,120,140,0.06) 30%,rgba(80,100,120,0.12) 100%);
  animation:fog-drift var(--speed,40s) ease-in-out infinite;
  opacity:var(--opacity,0.6);
}
.fog-layer:nth-child(2){animation-direction:reverse}
@keyframes fog-drift{
  0%{transform:translateX(-12%) scaleY(1)}
  33%{transform:translateX(8%) scaleY(1.1)}
  66%{transform:translateX(-5%) scaleY(0.9)}
  100%{transform:translateX(-12%) scaleY(1)}
}

/* Mountain glow */
.mountain-glow{
  position:absolute;bottom:20%;left:45%;width:180px;height:300px;
  background:radial-gradient(ellipse,rgba(232,113,42,0.04) 0%,transparent 70%);
  pointer-events:none;z-index:3;
  opacity:0;transition:opacity 3s ease;
}
.mountain-glow.visible{opacity:1}

/* ‚îÄ‚îÄ UI Overlay ‚îÄ‚îÄ */
.ui-overlay{
  position:absolute;inset:0;display:flex;flex-direction:column;
  justify-content:flex-end;align-items:center;
  padding:12px;z-index:20;pointer-events:none;
}

/* Top bar */
.top-bar{
  position:absolute;top:0;left:0;right:0;
  display:flex;justify-content:space-between;align-items:center;
  padding:10px 16px;pointer-events:auto;
  background:linear-gradient(180deg,rgba(0,0,0,0.7) 0%,rgba(0,0,0,0.2) 60%,transparent 100%);
}
.game-title{
  font-family:'Cinzel',serif;font-size:13px;font-weight:600;
  letter-spacing:0.12em;text-transform:uppercase;color:var(--text-secondary);
}
.level-display{
  font-family:'JetBrains Mono',monospace;font-size:11px;
  color:var(--text-dim);letter-spacing:0.08em;
}
.home-link{
  color:var(--text-dim);text-decoration:none;font-size:11px;
  font-family:'JetBrains Mono',monospace;letter-spacing:0.05em;
  transition:color 0.3s;
}
.home-link:hover{color:var(--text-primary)}

/* Altitude indicator */
.altitude{
  position:absolute;top:55px;right:14px;
  font-family:'JetBrains Mono',monospace;font-size:9px;
  color:var(--text-dim);letter-spacing:0.08em;
  writing-mode:vertical-rl;text-orientation:mixed;
  opacity:0.4;pointer-events:none;z-index:25;
}

/* ‚îÄ‚îÄ Question panel ‚Äî compact, translucent, bottom-hugging ‚îÄ‚îÄ */
.question-panel{
  pointer-events:auto;
  width:100%;max-width:480px;
  background:linear-gradient(135deg,rgba(5,8,16,0.62) 0%,rgba(8,14,26,0.68) 100%);
  backdrop-filter:blur(20px);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:12px;
  padding:14px 16px;
  transform:translateY(0);
  transition:transform 0.5s cubic-bezier(0.34,1.56,0.64,1),opacity 0.4s ease;
  opacity:1;
  margin-bottom:env(safe-area-inset-bottom,0);
  box-shadow:0 -2px 16px rgba(0,0,0,0.25);
  max-height:calc(36vh);
  overflow-y:auto;
}
.question-panel.hidden{
  transform:translateY(30px);opacity:0;pointer-events:none;
}
.question-level{
  font-family:'JetBrains Mono',monospace;font-size:9px;
  color:var(--campfire);letter-spacing:0.15em;text-transform:uppercase;
  margin-bottom:1px;
}
.question-philosopher{
  font-family:'JetBrains Mono',monospace;font-size:8px;
  color:var(--text-dim);letter-spacing:0.1em;
  margin-bottom:6px;
}
.question-text{
  font-family:'Crimson Text',serif;font-size:15px;line-height:1.4;
  color:var(--text-primary);margin-bottom:10px;
  font-style:italic;
}
.options{display:flex;flex-direction:column;gap:4px}
.option-btn{
  display:flex;align-items:flex-start;gap:8px;
  width:100%;padding:8px 12px;
  background:rgba(255,255,255,0.025);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:7px;
  color:var(--text-secondary);
  font-family:'Crimson Text',serif;font-size:14px;line-height:1.3;
  text-align:left;cursor:pointer;
  transition:all 0.25s ease;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  min-height:34px;
  position:relative;
  overflow:hidden;
}
.option-btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,0.03),transparent);
  opacity:0;transition:opacity 0.3s;
}
.option-btn:hover{
  background:rgba(255,255,255,0.07);
  border-color:rgba(255,255,255,0.12);
  color:var(--text-primary);
  transform:translateX(2px);
}
.option-btn:hover::before{opacity:1}
.option-btn:active{transform:scale(0.98)}
.option-btn .opt-letter{
  font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:700;
  color:var(--text-dim);min-width:18px;padding-top:1px;
  transition:color 0.3s;
}
.option-btn:hover .opt-letter{color:var(--campfire)}
.option-btn.correct{
  background:rgba(34,197,94,0.15);border-color:rgba(34,197,94,0.4);
  color:#6ee7a0;
  animation:correct-pulse 0.6s ease;
}
@keyframes correct-pulse{
  0%{box-shadow:0 0 0 0 rgba(34,197,94,0.3)}
  50%{box-shadow:0 0 0 8px rgba(34,197,94,0)}
  100%{box-shadow:none}
}
.option-btn.wrong{
  background:rgba(239,68,68,0.12);border-color:rgba(239,68,68,0.3);
  color:#fca5a5;
  animation:wrong-shake 0.4s ease;
}
@keyframes wrong-shake{
  0%,100%{transform:translateX(0)}
  20%{transform:translateX(-6px)}
  40%{transform:translateX(6px)}
  60%{transform:translateX(-4px)}
  80%{transform:translateX(4px)}
}
.option-btn.disabled{pointer-events:none;opacity:0.5}

/* Feedback toast */
.feedback{
  position:absolute;left:50%;transform:translateX(-50%);
  bottom:calc(100% + 8px);
  background:rgba(5,8,16,0.82);
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:8px;
  padding:8px 14px;
  font-family:'Crimson Text',serif;font-size:13px;font-style:italic;
  color:var(--text-secondary);line-height:1.35;
  text-align:center;
  opacity:0;transform:translateX(-50%) translateY(10px);
  transition:all 0.5s ease;
  pointer-events:none;
  max-width:88vw;
  white-space:normal;
}
.feedback.visible{
  opacity:1;transform:translateX(-50%) translateY(0);
}

/* ‚îÄ‚îÄ Start Screen ‚îÄ‚îÄ */
.screen-overlay{
  position:absolute;inset:0;z-index:50;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:24px;
  background:rgba(3,3,6,0.96);
  transition:opacity 1s ease;
  text-align:center;
}
.screen-overlay.hidden{opacity:0;pointer-events:none}
.start-elk{
  font-size:64px;margin-bottom:16px;line-height:1;
  animation:elk-breathe 3s ease-in-out infinite;
}
.start-title{
  font-family:'Cinzel',serif;font-size:28px;font-weight:700;
  letter-spacing:0.08em;margin-bottom:8px;
  background:linear-gradient(135deg,var(--text-primary),var(--gold));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;
}
.start-sub{
  font-family:'Crimson Text',serif;font-size:17px;font-style:italic;
  color:var(--text-secondary);margin-bottom:12px;max-width:420px;line-height:1.5;
}
.start-hint{
  font-family:'JetBrains Mono',monospace;font-size:10px;
  color:var(--text-dim);margin-bottom:28px;letter-spacing:0.08em;
}
.start-btn,.summit-btn{
  font-family:'Cinzel',serif;font-size:14px;font-weight:600;
  letter-spacing:0.15em;text-transform:uppercase;
  padding:14px 40px;
  background:linear-gradient(135deg,rgba(232,113,42,0.2),rgba(212,168,67,0.2));
  border:1px solid rgba(232,113,42,0.4);
  border-radius:10px;
  color:var(--gold);cursor:pointer;
  transition:all 0.3s ease;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  min-height:44px;
  position:relative;
  overflow:hidden;
}
.start-btn::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,transparent 30%,rgba(212,168,67,0.1) 50%,transparent 70%);
  animation:btn-shimmer 3s ease-in-out infinite;
}
@keyframes btn-shimmer{
  0%{transform:translateX(-100%)}
  100%{transform:translateX(100%)}
}
.start-btn:hover,.summit-btn:hover{
  background:linear-gradient(135deg,rgba(232,113,42,0.3),rgba(212,168,67,0.3));
  box-shadow:0 0 30px rgba(232,113,42,0.2);
  transform:translateY(-2px);
}
.start-btn:active,.summit-btn:active{transform:scale(0.97)}

/* ‚îÄ‚îÄ Summit Screen ‚îÄ‚îÄ */
.summit-screen{
  position:absolute;inset:0;z-index:60;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:24px;text-align:center;
  background:radial-gradient(ellipse at 50% 35%,rgba(212,168,67,0.12) 0%,rgba(5,5,10,0.98) 55%);
  opacity:0;pointer-events:none;
  transition:opacity 1.5s ease;
}
.summit-screen.visible{opacity:1;pointer-events:auto}
.summit-stars{position:absolute;inset:0;overflow:hidden;pointer-events:none}
.summit-burst{
  position:absolute;width:4px;height:4px;border-radius:50%;
  background:var(--gold);
  animation:burst var(--d,2s) ease-out infinite;
  opacity:0;
}
@keyframes burst{
  0%{opacity:0;transform:translate(0,0) scale(0)}
  20%{opacity:1;transform:translate(var(--tx),var(--ty)) scale(1)}
  100%{opacity:0;transform:translate(calc(var(--tx)*2.5),calc(var(--ty)*2.5)) scale(0)}
}
.summit-ring{
  position:absolute;left:50%;top:38%;transform:translate(-50%,-50%);
  width:120px;height:120px;border-radius:50%;
  border:1px solid rgba(212,168,67,0.2);
  animation:ring-expand 3s ease-out infinite;
  pointer-events:none;
}
.summit-ring:nth-child(2){animation-delay:1s}
.summit-ring:nth-child(3){animation-delay:2s}
@keyframes ring-expand{
  0%{width:80px;height:80px;opacity:0.5;border-color:rgba(212,168,67,0.3)}
  100%{width:300px;height:300px;opacity:0;border-color:rgba(212,168,67,0)}
}
.summit-elk{font-size:72px;margin-bottom:16px;line-height:1;position:relative;z-index:1}
.summit-crown{
  position:absolute;top:-20px;left:50%;transform:translateX(-50%);
  font-size:30px;animation:float 2s ease-in-out infinite alternate;
}
@keyframes float{0%{transform:translateX(-50%) translateY(0)}100%{transform:translateX(-50%) translateY(-8px)}}
.summit-title{
  font-family:'Cinzel',serif;font-size:24px;font-weight:700;
  color:var(--gold);letter-spacing:0.08em;margin-bottom:12px;
  position:relative;z-index:1;
  text-shadow:0 0 30px rgba(212,168,67,0.3);
}
.summit-msg{
  font-family:'Crimson Text',serif;font-size:17px;font-style:italic;
  color:var(--text-secondary);margin-bottom:24px;max-width:420px;line-height:1.5;
  position:relative;z-index:1;
}
.summit-stats{
  display:flex;gap:24px;margin-bottom:28px;position:relative;z-index:1;
  flex-wrap:wrap;justify-content:center;
}
.stat{display:flex;flex-direction:column;align-items:center;gap:4px}
.stat-val{
  font-family:'JetBrains Mono',monospace;font-size:20px;font-weight:700;
  color:var(--gold-bright);
}
.stat-label{
  font-family:'JetBrains Mono',monospace;font-size:10px;
  color:var(--text-dim);letter-spacing:0.1em;text-transform:uppercase;
}
.summit-actions{
  display:flex;gap:12px;flex-wrap:wrap;justify-content:center;
  position:relative;z-index:1;
}
.summit-btn.share{
  background:linear-gradient(135deg,rgba(212,168,67,0.25),rgba(240,199,94,0.25));
  border-color:var(--gold);
}
.summit-btn.replay{
  background:var(--glass);border-color:var(--glass-border);color:var(--text-secondary);
}
.summit-btn.replay:hover{color:var(--text-primary)}
.share-toast{
  font-family:'JetBrains Mono',monospace;font-size:11px;
  color:var(--gold);margin-top:8px;opacity:0;transition:opacity 0.3s;
  position:relative;z-index:1;
}
.share-toast.visible{opacity:1}

/* Progress bar */
.progress-wrap{
  position:absolute;top:44px;left:16px;right:16px;
  height:2px;background:rgba(255,255,255,0.04);border-radius:2px;
  overflow:hidden;z-index:25;
}
.progress-bar{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--campfire),var(--gold));
  border-radius:2px;
  transition:width 1s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow:0 0 6px rgba(232,113,42,0.3);
}

/* Golden glow at summit */
.summit-glow{
  position:absolute;top:3%;left:50%;transform:translateX(-50%);
  width:300px;height:300px;
  background:radial-gradient(circle,rgba(212,168,67,0.15) 0%,rgba(212,168,67,0.04) 40%,transparent 70%);
  border-radius:50%;opacity:0;
  transition:opacity 2.5s ease;
  z-index:3;pointer-events:none;
}
.summit-glow.visible{opacity:1}

/* Elevation vignette */
.vignette{
  position:absolute;inset:0;
  background:radial-gradient(ellipse at 50% 50%,transparent 55%,rgba(0,0,0,0.5) 100%);
  pointer-events:none;z-index:8;
  transition:background 2s ease;
}

/* Responsive */
@media(max-width:480px){
  .question-text{font-size:14px}
  .option-btn{font-size:13px;padding:7px 10px}
  .options{gap:3px}
  .start-title{font-size:22px}
  .summit-title{font-size:20px}
  .station{width:20px;height:20px}
  .station-num{font-size:7px}
  .station.reached::before{font-size:9px;top:-14px}
  .elk{font-size:22px}
  .question-panel{padding:10px 12px;border-radius:10px;max-height:38vh}
  .top-bar{padding:8px 12px}
  .summit-stats{gap:16px}
  .altitude{display:none}
}
@media(max-width:360px){
  .question-panel{padding:8px 10px;max-height:40vh}
  .question-text{font-size:13px;margin-bottom:8px}
  .option-btn{font-size:12px;padding:6px 8px;gap:5px;min-height:30px}
  .options{gap:3px}
}
@media(min-height:800px){
  .question-panel{margin-bottom:16px;max-height:34vh}
}
</style>
</head>
<body>

<!-- Start Screen -->
<div class="screen-overlay" id="startScreen">
  <div class="start-elk">ü¶å</div>
  <h1 class="start-title">Mountain Ascent</h1>
  <p class="start-sub">"Man is a tragic animal. Not because of his smallness, but because he is too well endowed." ‚Äî Peter Wessel Zapffe</p>
  <p class="start-hint">10 camps ¬∑ Zapffe ¬∑ Camus ¬∑ Kierkegaard ¬∑ Nietzsche ¬∑ Sartre ¬∑ Heidegger ¬∑ Schopenhauer</p>
  <button class="start-btn" id="startBtn" onclick="startGame()">Begin the Climb</button>
</div>

<!-- Summit Screen -->
<div class="summit-screen" id="summitScreen">
  <div class="summit-stars" id="summitStars"></div>
  <div class="summit-ring"></div>
  <div class="summit-ring"></div>
  <div class="summit-ring"></div>
  <div style="position:relative;display:inline-block">
    <div class="summit-crown">üëë</div>
    <div class="summit-elk">ü¶å</div>
  </div>
  <h2 class="summit-title">Summit Reached</h2>
  <p class="summit-msg">You have carried the antlers to the summit. The burden becomes beautiful when shared. ü¶å</p>
  <div class="summit-stats" id="summitStats"></div>
  <div class="summit-actions">
    <button class="summit-btn share" onclick="shareResult()">Share Your Climb</button>
    <button class="summit-btn replay" onclick="restartGame()">Climb Again</button>
  </div>
  <div class="share-toast" id="shareToast">Copied to clipboard</div>
  <div style="margin-top:18px;position:relative;z-index:1">
    <a href="index.html" class="home-link" style="font-size:13px">‚Üê Return to $ELK</a>
  </div>
</div>

<!-- Game Scene -->
<div class="scene" id="scene">
  <div class="sky" id="sky"></div>
  <div class="stars" id="starsContainer"></div>
  <div id="shootingStarsContainer"></div>
  <div class="aurora" id="aurora">
    <div class="aurora-band"></div>
    <div class="aurora-band"></div>
    <div class="aurora-band"></div>
  </div>
  <div class="summit-glow" id="summitGlow"></div>
  <div class="mountain-glow" id="mountainGlow"></div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!--  THE MOUNTAIN ‚Äî A layered landscape masterpiece -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

  <!-- Layer 5: Most distant range ‚Äî barely visible silhouettes -->
  <svg style="position:absolute;bottom:0;left:0;width:100%;height:55%;opacity:0.12;pointer-events:none" viewBox="0 0 1600 400" preserveAspectRatio="none">
    <polygon points="0,400 40,300 90,270 140,290 210,240 280,260 340,220 420,250 490,200 560,230 640,190 720,220 790,180 870,210 950,240 1020,200 1100,230 1180,260 1250,220 1330,250 1400,270 1500,290 1600,400" fill="#050810"/>
  </svg>

  <!-- Layer 4: Distant range -->
  <svg style="position:absolute;bottom:0;left:0;width:100%;height:60%;opacity:0.18;pointer-events:none" viewBox="0 0 1600 450" preserveAspectRatio="none">
    <polygon points="0,450 60,340 130,300 200,320 270,270 350,290 420,240 500,280 570,230 650,260 720,210 800,250 870,220 940,260 1020,230 1090,270 1160,240 1240,280 1310,300 1400,320 1500,340 1600,450" fill="#060a12"/>
    <polygon points="0,450 100,360 180,320 260,350 340,290 430,310 510,260 600,300 680,250 760,280 850,240 930,270 1010,290 1080,260 1160,290 1240,310 1320,340 1400,320 1500,360 1600,450" fill="#070c14" opacity="0.7"/>
  </svg>

  <!-- Layer 3: Mid-range peaks ‚Äî flanking mountains -->
  <svg style="position:absolute;bottom:0;left:0;width:100%;height:68%;opacity:0.25;pointer-events:none" viewBox="0 0 1600 500" preserveAspectRatio="none">
    <!-- Left flanking range -->
    <polygon points="0,500 20,380 60,340 100,310 140,290 190,260 230,280 280,240 320,260 370,230 410,250 460,270 510,300 560,330 620,350 680,400 740,500" fill="#080e18"/>
    <!-- Right flanking range -->
    <polygon points="860,500 920,400 980,350 1030,320 1080,290 1130,260 1180,240 1230,260 1280,230 1330,250 1380,270 1420,290 1460,310 1510,340 1560,370 1600,500" fill="#080e18"/>
  </svg>

  <!-- Layer 2: Near-range secondary peaks -->
  <svg style="position:absolute;bottom:0;left:0;width:100%;height:75%;opacity:0.3;pointer-events:none" viewBox="0 0 1600 550" preserveAspectRatio="none">
    <defs>
      <linearGradient id="nearRange" x1="0.5" y1="0" x2="0.5" y2="1">
        <stop offset="0%" stop-color="#0c1220"/>
        <stop offset="60%" stop-color="#0a1018"/>
        <stop offset="100%" stop-color="#080d14"/>
      </linearGradient>
    </defs>
    <!-- Left secondary peak -->
    <polygon points="0,550 30,420 80,370 130,340 180,310 230,280 280,310 320,330 380,360 440,400 500,440 550,480 600,550" fill="url(#nearRange)"/>
    <!-- Right secondary peak -->
    <polygon points="1000,550 1050,480 1100,440 1150,400 1210,360 1270,330 1320,300 1370,280 1420,310 1460,340 1510,370 1560,420 1600,550" fill="url(#nearRange)"/>
  </svg>

  <!-- Layer 1: THE MAIN MOUNTAIN ‚Äî the centerpiece -->
  <svg id="mountainSvg" class="mountain-svg" viewBox="0 0 1400 800" preserveAspectRatio="xMidYMax meet">
    <defs>
      <!-- Main mountain gradient ‚Äî purple summit to forest base -->
      <linearGradient id="mtGrad" x1="0.5" y1="0" x2="0.5" y2="1">
        <stop offset="0%" stop-color="#1c1535"/>
        <stop offset="8%" stop-color="#181a30"/>
        <stop offset="18%" stop-color="#14202c"/>
        <stop offset="35%" stop-color="#112520"/>
        <stop offset="55%" stop-color="#0e2018"/>
        <stop offset="75%" stop-color="#0c1c14"/>
        <stop offset="100%" stop-color="#091810"/>
      </linearGradient>
      <!-- Snow gradient -->
      <linearGradient id="snowGrad" x1="0.5" y1="0" x2="0.5" y2="1">
        <stop offset="0%" stop-color="rgba(215,230,248,0.22)"/>
        <stop offset="50%" stop-color="rgba(200,218,240,0.10)"/>
        <stop offset="100%" stop-color="rgba(200,215,235,0)"/>
      </linearGradient>
      <!-- Left face shadow -->
      <linearGradient id="leftShadow" x1="0" y1="0" x2="1" y2="0.3">
        <stop offset="0%" stop-color="rgba(0,0,0,0.18)"/>
        <stop offset="100%" stop-color="rgba(0,0,0,0)"/>
      </linearGradient>
      <!-- Right highlight -->
      <linearGradient id="rightLight" x1="1" y1="0" x2="0" y2="0.3">
        <stop offset="0%" stop-color="rgba(160,180,220,0.03)"/>
        <stop offset="100%" stop-color="rgba(0,0,0,0)"/>
      </linearGradient>
      <!-- Tree gradient -->
      <linearGradient id="treeGrad" x1="0.5" y1="0" x2="0.5" y2="1">
        <stop offset="0%" stop-color="#0c1e10"/>
        <stop offset="100%" stop-color="#071408"/>
      </linearGradient>
      <!-- Moonlight shimmer for ridgelines -->
      <linearGradient id="ridgeShimmer" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="rgba(200,215,240,0.06)"/>
        <stop offset="100%" stop-color="rgba(200,215,240,0)"/>
      </linearGradient>
      <filter id="mtGlow">
        <feGaussianBlur stdDeviation="2" result="blur"/>
        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="softGlow">
        <feGaussianBlur stdDeviation="4" result="blur"/>
        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
    </defs>

    <!-- Main mountain body ‚Äî wide, natural shape with irregular edges -->
    <path d="M700,35 L695,48 688,62 678,82 665,105 650,130 638,152 622,178 608,200
             590,228 575,252 558,278 540,305 525,328 505,358 488,382 468,410
             450,435 430,462 408,490 385,518 360,545 332,572 305,595 275,620
             248,642 218,665 188,685 155,705 120,725 85,745 50,765 20,780 0,800
             1400,800 1380,780 1350,765 1315,745 1280,725 1248,705 1215,685
             1185,665 1158,642 1130,620 1102,595 1078,572 1052,545 1028,518
             1005,490 985,462 965,435 948,410 930,382 912,358 895,328 878,305
             862,278 845,252 830,228 815,200 800,178 788,152 775,130 762,105
             750,82 740,62 732,48 725,40 715,35 708,34 Z"
         fill="url(#mtGrad)"/>

    <!-- Left face shadow overlay -->
    <path d="M700,35 L695,48 688,62 678,82 665,105 650,130 638,152 622,178 608,200
             590,228 575,252 558,278 540,305 525,328 505,358 488,382 468,410
             450,435 430,462 408,490 385,518 360,545 332,572 305,595 275,620
             248,642 218,665 188,685 155,705 120,725 85,745 50,765 20,780 0,800
             700,800 Z"
         fill="url(#leftShadow)"/>

    <!-- Right face subtle moonlight -->
    <path d="M700,35 L725,40 732,48 740,62 750,82 762,105 775,130 788,152 800,178
             815,200 830,228 845,252 862,278 878,305 895,328 912,358 930,382
             948,410 965,435 985,462 1005,490 1028,518 1052,545 1078,572
             1102,595 1130,620 1158,642 1185,665 1215,685 1248,705 1280,725
             1315,745 1350,765 1380,780 1400,800 700,800 Z"
         fill="url(#rightLight)"/>

    <!-- Snow cap ‚Äî irregular, realistic -->
    <path d="M700,35 L695,48 688,62 678,82 665,105 650,130 645,138
             655,140 668,135 680,142 692,136 700,140 712,136 724,142
             735,135 748,140 758,132 762,105 750,82 740,62 732,48 725,40 715,35 708,34 Z"
         fill="url(#snowGrad)"/>
    <!-- Inner snow peak -->
    <path d="M700,35 L695,48 690,58 694,60 700,55 706,60 712,56 715,48 710,38 705,35 Z"
         fill="rgba(230,240,255,0.12)"/>
    <!-- Snow patches on right face -->
    <path d="M745,100 L755,115 760,128 752,130 748,122 740,118 738,108 Z"
         fill="rgba(215,230,248,0.06)"/>
    <path d="M770,150 L782,170 785,180 778,178 772,168 765,158 Z"
         fill="rgba(215,230,248,0.04)"/>

    <!-- Primary ridgelines ‚Äî moonlit edges -->
    <line x1="700" y1="35" x2="468" y2="410" stroke="rgba(200,215,240,0.025)" stroke-width="1"/>
    <line x1="700" y1="35" x2="930" y2="382" stroke="rgba(200,215,240,0.03)" stroke-width="1"/>
    <line x1="700" y1="35" x2="305" y2="595" stroke="rgba(200,215,240,0.018)" stroke-width="0.8"/>
    <line x1="700" y1="35" x2="1102" y2="595" stroke="rgba(200,215,240,0.02)" stroke-width="0.8"/>
    <line x1="700" y1="35" x2="188" y2="685" stroke="rgba(200,215,240,0.012)" stroke-width="0.5"/>
    <line x1="700" y1="35" x2="1215" y2="685" stroke="rgba(200,215,240,0.015)" stroke-width="0.5"/>

    <!-- Secondary ridges ‚Äî rock face texture -->
    <line x1="665" y1="105" x2="488" y2="382" stroke="rgba(200,215,240,0.015)" stroke-width="0.5"/>
    <line x1="762" y1="105" x2="948" y2="410" stroke="rgba(200,215,240,0.018)" stroke-width="0.5"/>
    <line x1="638" y1="152" x2="408" y2="490" stroke="rgba(200,215,240,0.01)" stroke-width="0.5"/>
    <line x1="788" y1="152" x2="1005" y2="490" stroke="rgba(200,215,240,0.012)" stroke-width="0.5"/>

    <!-- Gullies/crevices ‚Äî dark accent lines -->
    <line x1="680" y1="82" x2="520" y2="340" stroke="rgba(0,0,0,0.06)" stroke-width="0.8"/>
    <line x1="720" y1="82" x2="880" y2="340" stroke="rgba(0,0,0,0.04)" stroke-width="0.8"/>
    <line x1="660" y1="130" x2="430" y2="462" stroke="rgba(0,0,0,0.04)" stroke-width="0.5"/>
    <line x1="765" y1="130" x2="980" y2="460" stroke="rgba(0,0,0,0.03)" stroke-width="0.5"/>

    <!-- Left shoulder spur -->
    <path d="M558,278 L540,305 518,338 495,370 470,405 445,435 418,468 390,500
             360,530 335,558 310,580 288,600 265,625 245,645 228,660
             360,720 420,680 470,640 515,595 555,548 580,505 595,465
             598,430 590,395 578,360 568,330 560,305 Z"
         fill="rgba(10,18,12,0.25)"/>

    <!-- Right shoulder spur -->
    <path d="M862,278 L878,305 898,338 920,370 942,405 965,435 988,468 1012,500
             1038,530 1065,558 1090,580 1115,600 1140,625 1162,645 1178,660
             1050,720 990,680 940,640 895,595 860,548 838,505 825,465
             822,430 828,395 838,360 848,330 855,305 Z"
         fill="rgba(8,14,10,0.2)"/>

    <!-- Tree line zone ‚Äî suggestion of forest -->
    <line x1="330" y1="565" x2="1075" y2="565" stroke="rgba(20,50,25,0.1)" stroke-width="1.5" stroke-dasharray="2 5"/>

    <!-- Individual tree silhouettes at treeline -->
    <!-- Left side trees -->
    <polygon points="280,630 284,600 288,630" fill="rgba(12,30,14,0.2)"/>
    <polygon points="295,625 300,590 305,625" fill="rgba(12,30,14,0.22)"/>
    <polygon points="315,618 320,582 325,618" fill="rgba(12,30,14,0.25)"/>
    <polygon points="338,610 344,570 350,610" fill="rgba(12,30,14,0.25)"/>
    <polygon points="365,600 372,558 379,600" fill="rgba(12,30,14,0.22)"/>
    <polygon points="392,592 398,548 404,592" fill="rgba(12,30,14,0.2)"/>
    <polygon points="418,585 425,540 432,585" fill="rgba(12,30,14,0.18)"/>
    <!-- Right side trees -->
    <polygon points="980,592 986,548 992,592" fill="rgba(12,30,14,0.2)"/>
    <polygon points="1005,600 1012,558 1019,600" fill="rgba(12,30,14,0.22)"/>
    <polygon points="1035,610 1042,570 1049,610" fill="rgba(12,30,14,0.25)"/>
    <polygon points="1062,618 1068,582 1074,618" fill="rgba(12,30,14,0.25)"/>
    <polygon points="1088,625 1094,590 1100,625" fill="rgba(12,30,14,0.22)"/>
    <polygon points="1112,630 1118,600 1124,630" fill="rgba(12,30,14,0.2)"/>

    <!-- Atmospheric glow at summit region -->
    <circle cx="700" cy="60" r="80" fill="rgba(180,160,220,0.015)" filter="url(#softGlow)"/>
  </svg>

  <!-- Trail lines SVG ‚Äî positioned to match main mountain -->
  <svg class="trail-line" id="trailLines" viewBox="0 0 100 100" preserveAspectRatio="none"
       style="position:absolute;inset:0;width:100%;height:100%">
  </svg>

  <div id="stationsContainer"></div>
  <div class="elk idle" id="elk">ü¶å</div>

  <!-- Foreground forest silhouette ‚Äî bottom of scene -->
  <svg style="position:absolute;bottom:0;left:0;width:100%;height:15%;pointer-events:none;z-index:5;opacity:0.4" viewBox="0 0 1600 100" preserveAspectRatio="none">
    <polygon points="0,100 0,70 15,55 25,68 35,48 45,65 60,40 72,60 85,35 95,55 110,42 120,58 135,30 148,52 160,38 175,55 188,28 200,50 215,35 228,58 240,42 255,60 268,45 280,62 295,38 310,55 322,42 338,60 350,35 365,55 378,40 392,58 405,32 420,52 432,45 448,62 460,38 475,55 488,42 502,60 515,35 530,52 542,42 558,58 570,35 585,55 598,40 612,58 625,32 640,52 652,45 668,62 680,38 695,55 708,42 722,60 735,35 750,52 762,42 778,58 790,35 805,55 818,40 832,58 845,32 860,52 872,45 888,62 900,38 915,55 928,42 942,60 955,35 970,52 982,42 998,58 1010,35 1025,55 1038,40 1052,58 1065,32 1080,52 1092,45 1108,62 1120,38 1135,55 1148,42 1162,60 1175,35 1190,52 1202,42 1218,58 1230,35 1245,55 1258,40 1272,58 1285,32 1300,52 1312,45 1328,62 1340,38 1355,55 1368,42 1382,60 1395,35 1410,52 1422,42 1438,58 1450,35 1465,55 1478,40 1492,58 1505,45 1520,60 1535,48 1550,65 1565,55 1580,68 1600,70 1600,100" fill="#040a06"/>
  </svg>

  <div class="fog" id="fogContainer">
    <div class="fog-layer" style="--speed:35s;--opacity:0.7;height:80px"></div>
    <div class="fog-layer" style="--speed:48s;--opacity:0.5;height:60px;bottom:5%"></div>
    <div class="fog-layer" style="--speed:62s;--opacity:0.3;height:45px;bottom:12%"></div>
    <div class="fog-layer" style="--speed:75s;--opacity:0.15;height:30px;bottom:20%"></div>
  </div>

  <div class="wind-particles" id="windParticles"></div>
  <div class="snow-particles" id="snowParticles"></div>
  <div class="vignette" id="vignette"></div>

  <div class="ui-overlay">
    <div class="top-bar">
      <a href="index.html" class="home-link">$ELK</a>
      <span class="game-title">Mountain Ascent</span>
      <span class="level-display" id="levelDisplay">Camp 0/10</span>
    </div>
    <div class="progress-wrap"><div class="progress-bar" id="progressBar"></div></div>
    <div class="altitude" id="altitude">ALT 0m</div>

    <div class="question-panel hidden" id="questionPanel">
      <div class="feedback" id="feedback"></div>
      <div class="question-level" id="questionLevel">Base Camp</div>
      <div class="question-philosopher" id="questionPhilosopher"></div>
      <div class="question-text" id="questionText"></div>
      <div class="options" id="optionsContainer"></div>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// QUESTION DATABASE ‚Äî Challenging questions
// focused on the most well-known existential
// philosophers. All options are similar length.
// Covers: Nietzsche, Camus, Kierkegaard, Sartre,
// Heidegger, Schopenhauer, Zapffe, Dostoevsky,
// Beauvoir, Cioran
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QUESTIONS = {
  1: [
    { q: "Which philosopher wrote 'The Myth of Sisyphus'?", opts: ["Friedrich Nietzsche", "Albert Camus", "Jean-Paul Sartre", "Martin Heidegger"], ans: 1, tag: "Camus" },
    { q: "Nietzsche proclaimed 'God is dead' in which work?", opts: ["Thus Spoke Zarathustra", "Beyond Good and Evil", "The Gay Science", "Twilight of the Idols"], ans: 2, tag: "Nietzsche" },
    { q: "Kierkegaard is often called the father of:", opts: ["German idealism", "Logical positivism", "Existentialism", "Phenomenology"], ans: 2, tag: "Kierkegaard" },
    { q: "Which philosopher wrote 'Being and Nothingness'?", opts: ["Martin Heidegger", "Simone de Beauvoir", "Albert Camus", "Jean-Paul Sartre"], ans: 3, tag: "Sartre" },
    { q: "Heidegger's major work 'Being and Time' was published in:", opts: ["1907", "1917", "1927", "1937"], ans: 2, tag: "Heidegger" },
    { q: "Zapffe's most famous essay is titled:", opts: ["The Myth of Sisyphus", "The Last Messiah", "The Sickness Unto Death", "The Birth of Tragedy"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer's main work is called:", opts: ["Critique of Pure Reason", "The World as Will", "Phenomenology of Spirit", "Fear and Trembling"], ans: 1, tag: "Schopenhauer" },
    { q: "Which of these philosophers was Danish?", opts: ["Friedrich Nietzsche", "Arthur Schopenhauer", "Soren Kierkegaard", "Martin Heidegger"], ans: 2, tag: "Kierkegaard" },
    { q: "Camus won the Nobel Prize in:", opts: ["Literature", "Peace", "Philosophy", "Economics"], ans: 0, tag: "Camus" },
    { q: "Dostoevsky was a novelist from:", opts: ["France", "Germany", "Russia", "Denmark"], ans: 2, tag: "Dostoevsky" },
  ],
  2: [
    { q: "What did Sartre mean by 'existence precedes essence'?", opts: ["Nature defines us first", "We define ourselves by choices", "Essence is an illusion", "God creates our purpose"], ans: 1, tag: "Sartre" },
    { q: "In Camus, what is 'the absurd'?", opts: ["A type of humor", "Conflict of meaning and silence", "Religious skepticism", "Political rebellion"], ans: 1, tag: "Camus" },
    { q: "Nietzsche's 'Ubermensch' is best translated as:", opts: ["Super soldier", "Overman", "Perfect being", "Holy spirit"], ans: 1, tag: "Nietzsche" },
    { q: "Heidegger's term 'Dasein' roughly means:", opts: ["Pure reason", "Being-there", "World-spirit", "Inner peace"], ans: 1, tag: "Heidegger" },
    { q: "Kierkegaard wrote under pseudonyms mainly to:", opts: ["Avoid censorship laws", "Present multiple viewpoints", "Hide from creditors", "Impress his publisher"], ans: 1, tag: "Kierkegaard" },
    { q: "Schopenhauer believed the core of reality is:", opts: ["Pure reason", "Blind will", "Divine love", "Eternal form"], ans: 1, tag: "Schopenhauer" },
    { q: "Zapffe argued humans suffer because of:", opts: ["Economic inequality", "Overconsciousness", "Original sin", "Social isolation"], ans: 1, tag: "Zapffe" },
    { q: "Beauvoir's 'The Second Sex' primarily examines:", opts: ["Marxist theory", "Women's situation", "French history", "Literary criticism"], ans: 1, tag: "Beauvoir" },
    { q: "Dostoevsky's 'Underground Man' is defined by:", opts: ["Quiet contentment", "Bitter self-awareness", "Religious devotion", "Political ambition"], ans: 1, tag: "Dostoevsky" },
    { q: "Cioran was a philosophical pessimist from:", opts: ["Bulgaria", "Romania", "Hungary", "Slovakia"], ans: 1, tag: "Cioran" },
  ],
  3: [
    { q: "Camus said we must imagine Sisyphus as:", opts: ["Defiant", "Happy", "Angry", "Broken"], ans: 1, tag: "Camus" },
    { q: "Nietzsche's 'eternal recurrence' asks you to:", opts: ["Study ancient history", "Relive your life infinitely", "Reject all tradition", "Worship natural cycles"], ans: 1, tag: "Nietzsche" },
    { q: "Kierkegaard's 'leap of faith' involves:", opts: ["Rational calculation", "Commitment beyond proof", "Rejecting all belief", "Scientific experiment"], ans: 1, tag: "Kierkegaard" },
    { q: "Sartre's play 'No Exit' contains the line:", opts: ["'Freedom is nothing'", "'Hell is other people'", "'God is absent'", "'Life has no exit'"], ans: 1, tag: "Sartre" },
    { q: "Heidegger called everyday conformity:", opts: ["Bad faith", "Das Man", "Ressentiment", "The absurd"], ans: 1, tag: "Heidegger" },
    { q: "Zapffe listed how many defense mechanisms?", opts: ["Two", "Three", "Four", "Five"], ans: 2, tag: "Zapffe" },
    { q: "Which novel features the Grand Inquisitor?", opts: ["Crime and Punishment", "The Brothers Karamazov", "The Idiot", "Notes from Underground"], ans: 1, tag: "Dostoevsky" },
    { q: "Schopenhauer considered which art form supreme?", opts: ["Painting", "Music", "Poetry", "Sculpture"], ans: 1, tag: "Schopenhauer" },
    { q: "Beauvoir said 'One is not born, but becomes a:'", opts: ["Philosopher", "Woman", "Citizen", "Rebel"], ans: 1, tag: "Beauvoir" },
    { q: "Cioran's 'The Trouble with Being Born' is about:", opts: ["Childhood trauma", "The curse of existence", "Medical ethics", "Population growth"], ans: 1, tag: "Cioran" },
  ],
  4: [
    { q: "Which is NOT one of Zapffe's four defense mechanisms?", opts: ["Isolation", "Sublimation", "Transcendence", "Distraction"], ans: 2, tag: "Zapffe" },
    { q: "Nietzsche's 'amor fati' translates to:", opts: ["Love of wisdom", "Love of fate", "Love of power", "Love of truth"], ans: 1, tag: "Nietzsche" },
    { q: "Kierkegaard's three stages of existence are:", opts: ["Faith, hope, charity", "Thesis, antithesis, synthesis", "Aesthetic, ethical, religious", "Sensory, rational, spiritual"], ans: 2, tag: "Kierkegaard" },
    { q: "Sartre's 'bad faith' refers to:", opts: ["Religious hypocrisy", "Self-deception about freedom", "Breaking a promise", "Political corruption"], ans: 1, tag: "Sartre" },
    { q: "Heidegger's 'Being-toward-death' argues mortality is:", opts: ["A medical problem", "Key to authentic life", "Best left unexamined", "A cultural construct"], ans: 1, tag: "Heidegger" },
    { q: "Camus distinguished himself from existentialists as:", opts: ["A rationalist", "An absurdist", "A nihilist", "A pragmatist"], ans: 1, tag: "Camus" },
    { q: "In Zapffe's framework, religion is an example of:", opts: ["Sublimation", "Anchoring", "Distraction", "Isolation"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer's ethics are grounded in:", opts: ["Duty and law", "Compassion", "Self-interest", "Social contract"], ans: 1, tag: "Schopenhauer" },
    { q: "Dostoevsky's Raskolnikov murders to test his:", opts: ["Courage in combat", "Theory of great men", "Religious devotion", "Criminal technique"], ans: 1, tag: "Dostoevsky" },
    { q: "Beauvoir's existentialist ethics emphasize:", opts: ["Absolute moral rules", "Freedom and ambiguity", "National identity", "Economic equality"], ans: 1, tag: "Beauvoir" },
  ],
  5: [
    { q: "Nietzsche's 'master morality' values:", opts: ["Humility and pity", "Strength and nobility", "Obedience and faith", "Equality and justice"], ans: 1, tag: "Nietzsche" },
    { q: "Kierkegaard's 'Angst' is best described as:", opts: ["Fear of death", "Dizziness of freedom", "Social anxiety", "Religious doubt"], ans: 1, tag: "Kierkegaard" },
    { q: "Camus's 'The Rebel' argues revolt must include:", opts: ["Total destruction", "Human solidarity", "Political parties", "Armed resistance"], ans: 1, tag: "Camus" },
    { q: "Heidegger's 'thrownness' means we are:", opts: ["Rejected by society", "Cast into existence unchosen", "Thrown by circumstances", "Discarded by history"], ans: 1, tag: "Heidegger" },
    { q: "Zapffe's 'Sublimation' transforms suffering into:", opts: ["Political action", "Creative expression", "Physical endurance", "Religious worship"], ans: 1, tag: "Zapffe" },
    { q: "Sartre argued we are 'condemned' to be:", opts: ["Mortal", "Free", "Alone", "Guilty"], ans: 1, tag: "Sartre" },
    { q: "Schopenhauer saw the world as driven by:", opts: ["Divine providence", "Blind irrational striving", "Historical progress", "Rational development"], ans: 1, tag: "Schopenhauer" },
    { q: "Dostoevsky's Underground Man rejects:", opts: ["Religious belief", "Rational self-interest", "Political authority", "Artistic expression"], ans: 1, tag: "Dostoevsky" },
    { q: "Beauvoir argued freedom is meaningless without:", opts: ["Financial security", "Struggle for others' freedom", "Personal happiness", "Political power"], ans: 1, tag: "Beauvoir" },
    { q: "Cioran wrote that consciousness is a:", opts: ["Divine gift", "Evolutionary error", "Neutral faculty", "Moral compass"], ans: 1, tag: "Cioran" },
  ],
  6: [
    { q: "Nietzsche's 'genealogy of morals' traces values to:", opts: ["Divine revelation", "Historical power dynamics", "Pure rational thought", "Natural human instinct"], ans: 1, tag: "Nietzsche" },
    { q: "Heidegger's 'enframing' (Gestell) critiques:", opts: ["Modern art movements", "Technology's worldview", "Educational systems", "Democratic politics"], ans: 1, tag: "Heidegger" },
    { q: "Camus rejected 'philosophical suicide' which means:", opts: ["Taking one's own life", "Accepting false transcendence", "Abandoning philosophy", "Killing intellectual rivals"], ans: 1, tag: "Camus" },
    { q: "Kierkegaard's 'knight of faith' paradoxically:", opts: ["Rejects all worldly life", "Lives normally while embracing absurdity", "Fights for religious causes", "Retreats into monastery"], ans: 1, tag: "Kierkegaard" },
    { q: "Sartre said consciousness is always consciousness:", opts: ["Of itself alone", "Of something (intentional)", "Of God's presence", "Of moral duty"], ans: 1, tag: "Sartre" },
    { q: "Zapffe's 'Isolation' mechanism works by:", opts: ["Living physically alone", "Compartmentalizing dark thoughts", "Rejecting all community", "Building physical walls"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer argued art provides temporary:", opts: ["Financial reward", "Release from the will", "Social prestige", "Moral instruction"], ans: 1, tag: "Schopenhauer" },
    { q: "In Dostoevsky, Ivan Karamazov argues that without God:", opts: ["Life is sacred", "Everything is permitted", "Nature is divine", "Morality is stronger"], ans: 1, tag: "Dostoevsky" },
    { q: "Beauvoir criticized women being cast as:", opts: ["The weaker sex", "The Other", "The minority", "The opposition"], ans: 1, tag: "Beauvoir" },
    { q: "Zapffe's 'Distraction' involves:", opts: ["Deep meditation", "Intense focus on trivial activity", "Philosophical inquiry", "Creative artistic work"], ans: 1, tag: "Zapffe" },
  ],
  7: [
    { q: "Nietzsche's 'perspectivism' claims truth is:", opts: ["Absolute and singular", "Shaped by the knower", "Purely mathematical", "Democratically decided"], ans: 1, tag: "Nietzsche" },
    { q: "Heidegger's 'authenticity' requires confronting:", opts: ["Other philosophers", "One's own mortality", "Political injustice", "Scientific ignorance"], ans: 1, tag: "Heidegger" },
    { q: "For Kierkegaard, 'the sickness unto death' is:", opts: ["Terminal illness", "Despair itself", "Loss of faith", "Fear of dying"], ans: 1, tag: "Kierkegaard" },
    { q: "Sartre's 'nausea' reveals existence as:", opts: ["Logically ordered", "Contingent and groundless", "Divinely purposeful", "Morally structured"], ans: 1, tag: "Sartre" },
    { q: "Camus's absurd hero responds with:", opts: ["Quiet resignation", "Passionate revolt", "Rational planning", "Religious conversion"], ans: 1, tag: "Camus" },
    { q: "Zapffe saw consciousness as a biological:", opts: ["Crowning achievement", "Tragic overdevelopment", "Neutral adaptation", "Necessary survival tool"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer's pessimism holds that life is fundamentally:", opts: ["Meaningfully tragic", "Blindly suffering", "Quietly beautiful", "Slowly improving"], ans: 1, tag: "Schopenhauer" },
    { q: "Dostoevsky's 'idiot' Prince Myshkin represents:", opts: ["Political naivete", "Radical goodness", "Mental weakness", "Social climbing"], ans: 1, tag: "Dostoevsky" },
    { q: "Beauvoir's 'ethics of ambiguity' rejects:", opts: ["Personal freedom", "Absolute moral certainty", "Gender equality", "Political engagement"], ans: 1, tag: "Beauvoir" },
    { q: "Cioran said the act of being born is:", opts: ["A joyful miracle", "An irreversible catastrophe", "A neutral event", "A divine blessing"], ans: 1, tag: "Cioran" },
  ],
  8: [
    { q: "Nietzsche saw 'slave morality' as born from:", opts: ["Genuine compassion", "Ressentiment", "Natural instinct", "Divine command"], ans: 1, tag: "Nietzsche" },
    { q: "Heidegger argued modern man has forgotten the question of:", opts: ["Ethics", "Being", "Justice", "Beauty"], ans: 1, tag: "Heidegger" },
    { q: "Kierkegaard's 'Abraham paradox' concerns:", opts: ["Economic sacrifice", "Faith versus ethics", "Political loyalty", "Scientific discovery"], ans: 1, tag: "Kierkegaard" },
    { q: "Sartre's 'look of the Other' makes us feel:", opts: ["Loved and secure", "Objectified and judged", "Invisible and free", "Powerful and dominant"], ans: 1, tag: "Sartre" },
    { q: "Camus wrote 'In the depth of winter I found within me:'", opts: ["An endless sorrow", "An invincible summer", "A terrible darkness", "A growing madness"], ans: 1, tag: "Camus" },
    { q: "Zapffe would classify modern social media primarily as:", opts: ["Genuine connection", "Mass distraction", "Pure sublimation", "Effective anchoring"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer influenced which of these thinkers MOST?", opts: ["Karl Marx", "Nietzsche", "Immanuel Kant", "Georg Hegel"], ans: 1, tag: "Schopenhauer" },
    { q: "Dostoevsky's Grand Inquisitor says humanity prefers:", opts: ["Absolute freedom", "Miracle, mystery, authority", "Truth and justice", "Solitude and peace"], ans: 1, tag: "Dostoevsky" },
    { q: "Beauvoir saw existential freedom as requiring:", opts: ["Wealth and status", "Concrete social action", "Inner contemplation", "Religious guidance"], ans: 1, tag: "Beauvoir" },
    { q: "Zapffe's deepest paradox is that consciousness:", opts: ["Creates what it cures", "Heals what it wounds", "Must defend against itself", "Transcends its own limits"], ans: 2, tag: "Zapffe" },
  ],
  9: [
    { q: "Nietzsche's 'will to power' is fundamentally a drive toward:", opts: ["Political domination", "Self-overcoming and creation", "Material accumulation", "Social recognition"], ans: 1, tag: "Nietzsche" },
    { q: "Heidegger's 'clearing' (Lichtung) is where:", opts: ["Forests are cut down", "Being reveals itself", "Logic becomes clear", "Politics is decided"], ans: 1, tag: "Heidegger" },
    { q: "Kierkegaard's 'either/or' contrasts the:", opts: ["Sacred and profane life", "Aesthetic and ethical life", "Active and passive life", "Public and private life"], ans: 1, tag: "Kierkegaard" },
    { q: "Sartre argued that human reality is fundamentally:", opts: ["A being-in-itself", "A lack or nothingness", "A divine creation", "A material substance"], ans: 1, tag: "Sartre" },
    { q: "For Camus, the absurd emerges between:", opts: ["Rich and poor", "Human longing and world's silence", "Past and future", "Self and society"], ans: 1, tag: "Camus" },
    { q: "Zapffe's 'Anchoring' involves fixing life to:", opts: ["Geographic locations", "Stable values or goals", "Physical possessions", "Ancestral traditions"], ans: 1, tag: "Zapffe" },
    { q: "Schopenhauer saw compassion as recognizing:", opts: ["Social obligation", "Shared suffering in others", "Divine commandment", "Rational self-interest"], ans: 1, tag: "Schopenhauer" },
    { q: "Dostoevsky explored the idea that suffering:", opts: ["Should be eliminated", "Can redeem and transform", "Is always meaningless", "Only affects the weak"], ans: 1, tag: "Dostoevsky" },
    { q: "Cioran's aphoristic style was influenced most by:", opts: ["Hegel's dialectics", "Nietzsche's fragments", "Kant's critiques", "Marx's manifestos"], ans: 1, tag: "Cioran" },
    { q: "Beauvoir argued that aging reveals:", opts: ["Life's hidden beauty", "Existential vulnerability", "Wisdom's true value", "Society's compassion"], ans: 1, tag: "Beauvoir" },
  ],
  10: [
    { q: "If consciousness is the wound that cannot heal, the most Zapffean response is:", opts: ["Deny the wound exists", "Create beauty from the pain", "Seek a cure in science", "Simply stop thinking"], ans: 1, tag: "Zapffe" },
    { q: "Camus, Nietzsche, and Kierkegaard all agree that existence demands:", opts: ["Comfortable acceptance", "Extraordinary personal response", "Systematic rational analysis", "Collective political action"], ans: 1, tag: "All" },
    { q: "The elk reaches the summit and sees only more peaks. This represents:", opts: ["The futility of effort", "Meaning as perpetual becoming", "A navigational failure", "Nature's cruel indifference"], ans: 1, tag: "$ELK" },
    { q: "Zapffe would view a philosophy-themed meme community as:", opts: ["Pointless entertainment", "Honest collective coping", "Intellectual pretension", "Pure commercial venture"], ans: 1, tag: "Zapffe / $ELK" },
    { q: "'The weight never left, but I learned to call it wings.' This is closest to:", opts: ["Denial of reality", "Sublimation of suffering", "Willful ignorance", "Religious salvation"], ans: 1, tag: "Zapffe / $ELK" },
    { q: "The deepest tension in existentialism is between:", opts: ["Science and religion", "Freedom and groundlessness", "Wealth and poverty", "Nature and technology"], ans: 1, tag: "Existentialism" },
  ]
};

// ‚îÄ‚îÄ Philosophical quotes (expanded) ‚îÄ‚îÄ
const QUOTES = [
  "\"Man is a tragic animal.\" ‚Äî Zapffe",
  "\"The antlers are heavy. We carry them together.\"",
  "\"One must imagine Sisyphus happy.\" ‚Äî Camus",
  "\"To be aware is both the wound and the gift.\"",
  "\"We climb not to conquer, but to understand.\"",
  "\"The fog lifts for those who keep walking.\"",
  "\"Each campfire is proof that others have passed this way before.\"",
  "\"He who has a why to live can bear almost any how.\" ‚Äî Nietzsche",
  "\"Life can only be understood backwards; but it must be lived forwards.\" ‚Äî Kierkegaard",
  "\"Stars appear only when you climb above the noise.\"",
  "\"The mountain does not care. That is why the climb matters.\"",
  "\"What we carry defines us more than where we arrive.\"",
  "\"Freedom is what we do with what is done to us.\" ‚Äî Sartre",
  "\"In the depth of winter, I found an invincible summer.\" ‚Äî Camus",
  "\"The herd moves slowly, but it moves together.\"",
  "\"Anxiety is the dizziness of freedom.\" ‚Äî Kierkegaard",
  "\"At the treeline, silence becomes a companion.\"",
  "\"One night the antlers catch the moonlight, and the weight becomes wonder.\"",
  "\"To live is to suffer; to survive is to find meaning.\" ‚Äî Frankl",
  "\"Existence precedes essence.\" ‚Äî Sartre",
  "\"The higher we climb, the more we see ‚Äî and the more we must bear.\"",
  "\"Without music, life would be a mistake.\" ‚Äî Nietzsche",
  "\"The absurd does not liberate; it binds.\" ‚Äî Camus",
];

const WRONG_MESSAGES = [
  "The fog thickens... but the herd waits for you.",
  "A stumble on the path, not the end of the climb.",
  "Even the elk slips on loose stone. Rise again.",
  "The mountain tests all who dare to ascend.",
  "Consciousness is heavy. Take a breath and try again.",
  "The trail remains. Another step awaits.",
  "\"The struggle itself is enough to fill a man's heart.\" ‚Äî Camus",
  "One step back, but the summit has not moved.",
  "The wind pushes you back. Lean into it.",
  "Even Sisyphus had to watch the boulder roll down.",
  "The antlers catch on a branch. Untangle and continue.",
  "Nietzsche stumbled too. What matters is the next step.",
];

const LEVEL_NAMES = [
  "Base Camp", "Foothills", "Forest Trail", "Treeline",
  "Ridge Path", "Cloud Line", "High Pass", "Above the Clouds",
  "Near Summit", "The Ascent", "Summit"
];

const ALTITUDES = [0, 800, 1600, 2400, 3200, 4000, 4800, 5600, 6400, 7200, 8000];

// ‚îÄ‚îÄ Station positions (percentage of viewport) ‚îÄ‚îÄ
const STATION_COORDS = [
  { x: 50, y: 91 },
  { x: 44, y: 84 },
  { x: 56, y: 77 },
  { x: 43, y: 70 },
  { x: 55, y: 63 },
  { x: 45, y: 56 },
  { x: 54, y: 49 },
  { x: 46, y: 42 },
  { x: 53, y: 35 },
  { x: 48, y: 27 },
  { x: 50, y: 18 },
];

// ‚îÄ‚îÄ Game State ‚îÄ‚îÄ
let state = {
  level: 0,
  usedQuestions: {},
  slips: 0,
  questionsAnswered: 0,
  startTime: null,
  isAnimating: false,
  gameActive: false,
};
let shootingStarInterval = null;

// ‚îÄ‚îÄ DOM References ‚îÄ‚îÄ
const $ = id => document.getElementById(id);
const elk = $('elk');
const questionPanel = $('questionPanel');
const questionText = $('questionText');
const questionLevel = $('questionLevel');
const questionPhilosopher = $('questionPhilosopher');
const optionsContainer = $('optionsContainer');
const feedback = $('feedback');
const levelDisplay = $('levelDisplay');
const progressBar = $('progressBar');
const starsContainer = $('starsContainer');
const sky = $('sky');
const fogContainer = $('fogContainer');
const summitGlow = $('summitGlow');
const mountainGlow = $('mountainGlow');
const aurora = $('aurora');
const windParticles = $('windParticles');
const snowParticles = $('snowParticles');
const altitude = $('altitude');

// ‚îÄ‚îÄ Initialization ‚îÄ‚îÄ
function init() {
  createStars();
  createStations();
  createTrailLines();
  createWindParticles();
  createSnowParticles();
  positionElk(0, false);
}

function createStars() {
  let html = '';
  for (let i = 0; i < 150; i++) {
    const x = Math.random() * 100;
    const y = Math.random() * 50;
    const o = (0.2 + Math.random() * 0.8).toFixed(2);
    const d = (2 + Math.random() * 5).toFixed(1);
    const s = Math.random() < 0.08 ? 3 : (Math.random() < 0.25 ? 2 : 1);
    const color = Math.random() < 0.06 ? 'rgba(180,200,255,0.9)' : (Math.random() < 0.04 ? 'rgba(255,220,180,0.9)' : '#fff');
    html += `<div class="star" style="left:${x}%;top:${y}%;--o:${o};--d:${d}s;width:${s}px;height:${s}px;background:${color}"></div>`;
  }
  starsContainer.innerHTML = html;
}

function createWindParticles() {
  let html = '';
  for (let i = 0; i < 14; i++) {
    const y = 12 + Math.random() * 50;
    const w = 15 + Math.random() * 40;
    const speed = 4 + Math.random() * 6;
    const delay = Math.random() * 10;
    const o = (0.03 + Math.random() * 0.07).toFixed(2);
    html += `<div class="wind-particle" style="top:${y}%;--w:${w}px;--speed:${speed}s;--delay:${delay}s;--o:${o}"></div>`;
  }
  windParticles.innerHTML = html;
}

function createSnowParticles() {
  let html = '';
  for (let i = 0; i < 30; i++) {
    const x = Math.random() * 100;
    const s = (1 + Math.random() * 2).toFixed(0);
    const dur = 6 + Math.random() * 8;
    const delay = Math.random() * 12;
    const drift = (-30 + Math.random() * 60).toFixed(0);
    const o = (0.12 + Math.random() * 0.25).toFixed(2);
    html += `<div class="snow-p" style="left:${x}%;--s:${s}px;--dur:${dur}s;--delay:${delay}s;--drift:${drift}px;--o:${o}"></div>`;
  }
  snowParticles.innerHTML = html;
}

function createStations() {
  const container = $('stationsContainer');
  let html = '';
  for (let i = 0; i <= 10; i++) {
    const c = STATION_COORDS[i];
    const cls = i === 10 ? 'station summit' : 'station';
    html += `<div class="${cls}" id="station${i}" style="left:${c.x}%;top:${c.y}%">
      <span class="station-num">${i === 0 ? '‚õ∫' : i === 10 ? '‚õ∞' : i}</span>
    </div>`;
  }
  container.innerHTML = html;
}

function createTrailLines() {
  const svg = $('trailLines');
  let html = '';
  for (let i = 0; i < 10; i++) {
    const a = STATION_COORDS[i];
    const b = STATION_COORDS[i + 1];
    html += `<line id="trail${i}" x1="${a.x}" y1="${a.y}" x2="${b.x}" y2="${b.y}"/>`;
  }
  svg.innerHTML = html;
}

function triggerShootingStar() {
  const container = $('shootingStarsContainer');
  const star = document.createElement('div');
  star.className = 'shooting-star';
  const x = 20 + Math.random() * 60;
  const y = 3 + Math.random() * 20;
  const dx = (-120 - Math.random() * 150).toFixed(0);
  const dy = (60 + Math.random() * 100).toFixed(0);
  const dur = (0.6 + Math.random() * 0.8).toFixed(1);
  star.style.cssText = `left:${x}%;top:${y}%;--dx:${dx}px;--dy:${dy}px;--dur:${dur}s`;
  container.appendChild(star);
  requestAnimationFrame(() => star.classList.add('active'));
  setTimeout(() => star.remove(), parseFloat(dur) * 1000 + 100);
}

function positionElk(level, animate = true) {
  const c = STATION_COORDS[level];
  if (animate) {
    elk.style.transition = 'left 1.2s cubic-bezier(0.34,1.56,0.64,1), top 1.2s cubic-bezier(0.34,1.56,0.64,1)';
  } else {
    elk.style.transition = 'none';
  }
  elk.style.left = c.x + '%';
  elk.style.top = c.y + '%';
}

// ‚îÄ‚îÄ Shuffle utility ‚îÄ‚îÄ
function shuffleOptions(q) {
  const indexed = q.opts.map((text, i) => ({ text, isCorrect: i === q.ans }));
  // Fisher-Yates shuffle
  for (let i = indexed.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [indexed[i], indexed[j]] = [indexed[j], indexed[i]];
  }
  const newOpts = indexed.map(o => o.text);
  const newAns = indexed.findIndex(o => o.isCorrect);
  return { q: q.q, opts: newOpts, ans: newAns, tag: q.tag };
}

// ‚îÄ‚îÄ Game Flow ‚îÄ‚îÄ
function startGame() {
  $('startScreen').classList.add('hidden');
  state = {
    level: 0,
    usedQuestions: {},
    slips: 0,
    questionsAnswered: 0,
    startTime: Date.now(),
    isAnimating: false,
    gameActive: true,
  };

  // Reset visuals
  for (let i = 0; i <= 10; i++) {
    $(`station${i}`).classList.remove('reached');
  }
  document.querySelectorAll('#trailLines line').forEach(l => l.classList.remove('active'));
  starsContainer.classList.remove('visible', 'dim');
  sky.classList.remove('high', 'mid');
  summitGlow.classList.remove('visible');
  mountainGlow.classList.remove('visible');
  aurora.classList.remove('visible');
  windParticles.classList.remove('visible');
  snowParticles.classList.remove('visible');
  fogContainer.style.opacity = '1';
  elk.className = 'elk idle';
  progressBar.style.width = '0%';

  if (shootingStarInterval) clearInterval(shootingStarInterval);

  $('station0').classList.add('reached');
  positionElk(0, false);
  updateLevel();

  setTimeout(() => {
    questionPanel.classList.remove('hidden');
    showQuestion();
  }, 600);
}

function updateLevel() {
  levelDisplay.textContent = `Camp ${state.level}/10`;
  progressBar.style.width = (state.level * 10) + '%';
  altitude.textContent = `ALT ${ALTITUDES[state.level]}m`;

  if (state.level >= 3) {
    starsContainer.classList.add('dim');
    sky.classList.add('mid');
  }
  if (state.level >= 5) {
    starsContainer.classList.remove('dim');
    starsContainer.classList.add('visible');
    windParticles.classList.add('visible');
    mountainGlow.classList.add('visible');
  }
  if (state.level >= 6) {
    if (!shootingStarInterval) {
      shootingStarInterval = setInterval(() => {
        if (Math.random() < 0.4) triggerShootingStar();
      }, 3000);
    }
  }
  if (state.level >= 7) {
    sky.classList.remove('mid');
    sky.classList.add('high');
    fogContainer.style.opacity = '0.25';
    aurora.classList.add('visible');
  }
  if (state.level >= 8) {
    snowParticles.classList.add('visible');
  }
  if (state.level >= 9) {
    summitGlow.classList.add('visible');
  }
}

function getQuestion() {
  const targetLevel = state.level + 1;
  const pool = QUESTIONS[targetLevel];
  if (!pool) return null;

  if (!state.usedQuestions[targetLevel]) state.usedQuestions[targetLevel] = [];

  const available = pool.filter((_, i) => !state.usedQuestions[targetLevel].includes(i));
  if (available.length === 0) {
    state.usedQuestions[targetLevel] = [];
    return getQuestion();
  }

  const idx = Math.floor(Math.random() * available.length);
  const originalIdx = pool.indexOf(available[idx]);
  state.usedQuestions[targetLevel].push(originalIdx);

  return shuffleOptions(available[idx]);
}

function showQuestion() {
  const q = getQuestion();
  if (!q) return;

  const targetLevel = state.level + 1;
  let diffLabel;
  if (targetLevel <= 3) diffLabel = LEVEL_NAMES[targetLevel] + ' ¬∑ Easy';
  else if (targetLevel <= 6) diffLabel = LEVEL_NAMES[targetLevel] + ' ¬∑ Medium';
  else if (targetLevel <= 9) diffLabel = LEVEL_NAMES[targetLevel] + ' ¬∑ Hard';
  else diffLabel = 'The Summit ¬∑ Final Question';

  questionLevel.textContent = `Level ${targetLevel} ¬∑ ${diffLabel}`;
  questionPhilosopher.textContent = q.tag ? `‚Äî ${q.tag} ‚Äî` : '';
  questionText.textContent = q.q;

  const letters = ['A', 'B', 'C', 'D'];
  optionsContainer.innerHTML = q.opts.map((opt, i) =>
    `<button class="option-btn" onclick="selectAnswer(${i}, ${q.ans})">
      <span class="opt-letter">${letters[i]}</span>
      <span>${opt}</span>
    </button>`
  ).join('');

  hideFeedback();
}

function selectAnswer(selected, correct) {
  if (state.isAnimating) return;
  state.isAnimating = true;
  state.questionsAnswered++;

  const buttons = optionsContainer.querySelectorAll('.option-btn');
  buttons.forEach((btn, i) => {
    btn.classList.add('disabled');
    if (i === correct) btn.classList.add('correct');
    if (i === selected && selected !== correct) btn.classList.add('wrong');
  });

  if (selected === correct) {
    handleCorrect();
  } else {
    handleWrong();
  }
}

function handleCorrect() {
  state.level++;

  elk.classList.remove('idle');
  elk.classList.add('climb');
  positionElk(state.level);

  setTimeout(() => {
    $(`station${state.level}`).classList.add('reached');
    const trail = document.getElementById(`trail${state.level - 1}`);
    if (trail) trail.classList.add('active');
    updateLevel();
    elk.classList.remove('climb');
    elk.classList.add('idle');
  }, 500);

  const quote = QUOTES[Math.floor(Math.random() * QUOTES.length)];
  showFeedback(quote);

  if (state.level >= 10) {
    setTimeout(() => {
      questionPanel.classList.add('hidden');
      showSummit();
    }, 2000);
  } else {
    setTimeout(() => {
      state.isAnimating = false;
      showQuestion();
    }, 2400);
  }
}

function handleWrong() {
  state.slips++;
  const msg = WRONG_MESSAGES[Math.floor(Math.random() * WRONG_MESSAGES.length)];
  showFeedback(msg);

  elk.classList.remove('idle');

  if (state.level > 0) {
    state.level--;
    elk.classList.add('slip');
    positionElk(state.level);
    setTimeout(() => {
      elk.classList.remove('slip');
      elk.classList.add('idle');
    }, 800);

    const prev = state.level + 1;
    $(`station${prev}`).classList.remove('reached');
    const trail = document.getElementById(`trail${state.level}`);
    if (trail) trail.classList.remove('active');
    updateLevel();
  } else {
    elk.classList.add('slip');
    setTimeout(() => {
      elk.classList.remove('slip');
      elk.classList.add('idle');
    }, 800);
  }

  setTimeout(() => {
    state.isAnimating = false;
    showQuestion();
  }, 2400);
}

function showFeedback(text) {
  feedback.textContent = text;
  feedback.classList.add('visible');
}
function hideFeedback() {
  feedback.classList.remove('visible');
}

// ‚îÄ‚îÄ Summit ‚îÄ‚îÄ
function showSummit() {
  state.gameActive = false;
  elk.classList.remove('idle');
  elk.classList.add('celebrate');
  if (shootingStarInterval) { clearInterval(shootingStarInterval); shootingStarInterval = null; }

  const elapsed = Math.floor((Date.now() - state.startTime) / 1000);
  const mins = Math.floor(elapsed / 60);
  const secs = elapsed % 60;
  const timeStr = `${mins}m${secs.toString().padStart(2, '0')}s`;

  $('summitStats').innerHTML = `
    <div class="stat"><span class="stat-val">10/10</span><span class="stat-label">Camps</span></div>
    <div class="stat"><span class="stat-val">${state.questionsAnswered}</span><span class="stat-label">Questions</span></div>
    <div class="stat"><span class="stat-val">${state.slips}</span><span class="stat-label">Slips</span></div>
    <div class="stat"><span class="stat-val">${timeStr}</span><span class="stat-label">Time</span></div>
  `;

  const starsEl = $('summitStars');
  let bHtml = '';
  for (let i = 0; i < 50; i++) {
    const tx = (-200 + Math.random() * 400).toFixed(0);
    const ty = (-200 + Math.random() * 400).toFixed(0);
    const d = (1.5 + Math.random() * 2.5).toFixed(1);
    const delay = (Math.random() * 3).toFixed(1);
    const colors = ['#d4a843','#f0c75e','#fff','#e8712a','#ffd700'];
    const c = colors[Math.floor(Math.random() * colors.length)];
    bHtml += `<div class="summit-burst" style="left:50%;top:38%;--tx:${tx}px;--ty:${ty}px;--d:${d}s;animation-delay:${delay}s;background:${c}"></div>`;
  }
  starsEl.innerHTML = bHtml;

  state.timeStr = timeStr;
  setTimeout(() => $('summitScreen').classList.add('visible'), 400);
}

function shareResult() {
  const fires = 'üî•'.repeat(10);
  const text = `ü¶å‚õ∞Ô∏è $ELK Mountain Ascent üèîÔ∏è\n\nSummit reached!\n${fires}\n10/10 camps | ${state.slips} slip${state.slips !== 1 ? 's' : ''} | ${state.timeStr}\n\nThe antlers are heavy. We carry them together.`;

  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).then(() => {
      $('shareToast').classList.add('visible');
      setTimeout(() => $('shareToast').classList.remove('visible'), 2500);
    }).catch(() => fallbackCopy(text));
  } else {
    fallbackCopy(text);
  }
}

function fallbackCopy(text) {
  const ta = document.createElement('textarea');
  ta.value = text;
  ta.style.cssText = 'position:fixed;left:-9999px';
  document.body.appendChild(ta);
  ta.select();
  try { document.execCommand('copy'); } catch(e) {}
  document.body.removeChild(ta);
  $('shareToast').classList.add('visible');
  setTimeout(() => $('shareToast').classList.remove('visible'), 2500);
}

function restartGame() {
  $('summitScreen').classList.remove('visible');
  setTimeout(() => startGame(), 500);
}

// ‚îÄ‚îÄ Keyboard support ‚îÄ‚îÄ
document.addEventListener('keydown', e => {
  if (!state.gameActive || state.isAnimating) return;
  const map = { '1': 0, '2': 1, '3': 2, '4': 3, 'a': 0, 'b': 1, 'c': 2, 'd': 3 };
  const idx = map[e.key.toLowerCase()];
  if (idx !== undefined) {
    const btns = optionsContainer.querySelectorAll('.option-btn');
    if (btns[idx]) btns[idx].click();
  }
});

// Init
init();
</script>
</body>
</html>
