<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="$ELK - A Solana memecoin rooted in existential philosophy. The antlers are heavy. We carry them together.">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">

    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://cdn.jsdelivr.net https://unpkg.com https://www.gstatic.com https://*.supabase.co;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https: blob:;
        connect-src 'self' https: wss:;
        media-src 'self' https: blob: data:;
        frame-src 'self' https:;">

    <meta property="og:title" content="$ELK - The Burden We Carry Together">
    <meta property="og:description" content="We are carried through life by a series of sublimations—fleeting release valves for the pressure of being.">
    <meta property="og:image" content="https://raw.githubusercontent.com/exelkonsol/elk/main/images/newpreview.png">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://exelkonsol.github.io/elk/">
    <link rel="canonical" href="https://exelkonsol.github.io/elk/">

    <link rel="icon" href="https://raw.githubusercontent.com/exelkonsol/elk/main/images/pumpfun.png" type="image/png">
    <title>$ELK - The Burden We Carry Together</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // ============================================
        // SUPABASE SHARED VOTING SYSTEM
        // Real-time shared votes across all users
        // Falls back to localStorage if unavailable
        // ============================================

        // ==========================================
        // SUPABASE CONFIGURATION - UPDATE THESE!
        // ==========================================
        const SUPABASE_URL = 'https://zbugvtypukklxpvrzxra.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpidWd2dHlwdWtrbHhwdnJ6eHJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0MjMwNzgsImV4cCI6MjA4NTk5OTA3OH0.aHYE5M0NOsxqJakcKmKTi2MfaxZbPhmMsiz9Hi6zQMc';
        // ==========================================

        const ALLOWED_MECHANISMS = ['isolation', 'anchoring', 'distraction', 'sublimation'];
        const CYCLE_LENGTH_DAYS = 14;
        const CYCLE_LENGTH_MS = CYCLE_LENGTH_DAYS * 24 * 60 * 60 * 1000;

        // Storage keys for local state
        const STORAGE_KEYS = {
            HAS_VOTED: 'elk_has_voted',
            VOTED_MECH: 'elk_voted_mech',
            VOTED_CYCLE: 'elk_voted_cycle',
            LOCAL_VOTES: 'elk_local_votes'  // Fallback storage
        };

        let supabaseClient = null;
        let useSupabase = false;
        let votingEnabled = true;
        let isVoting = false;
        let currentCycle = 1;
        let currentVotes = { isolation: 0, anchoring: 0, distraction: 0, sublimation: 0 };
        let realtimeChannel = null;

        // Update connection status indicator
        const updateConnectionStatus = (status) => {
            const indicator = document.getElementById('vote-status-indicator');
            if (!indicator) return;
            const colors = {
                connected: 'bg-green-500/50',
                error: 'bg-red-500/50',
                loading: 'bg-yellow-500/50'
            };
            indicator.className = `w-2 h-2 rounded-full ${colors[status] || colors.loading} animate-pulse`;
        };

        // Update the UI with vote counts
        const updateVoteUI = (votes) => {
            if (votes) currentVotes = votes;
            ALLOWED_MECHANISMS.forEach(mech => {
                const el = document.querySelector(`[data-mechanism="${mech}"] .vote-count`);
                if (el) el.textContent = (currentVotes[mech] || 0).toLocaleString();
            });
        };

        // Lock buttons after voting
        const lockButtons = (votedMech) => {
            document.querySelectorAll('.vote-btn').forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                btn.textContent = "Voted";
            });
            const card = document.querySelector(`[data-mechanism="${votedMech}"]`);
            if (card) card.classList.add('voted');
        };

        // Reset buttons for new cycle
        const resetButtons = () => {
            document.querySelectorAll('.vote-btn').forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                btn.textContent = "Vote";
            });
            document.querySelectorAll('.mechanism-card').forEach(card => card.classList.remove('voted'));
        };

        // Sync vote lock state
        const syncVoteLock = () => {
            const votedCycle = parseInt(localStorage.getItem(STORAGE_KEYS.VOTED_CYCLE) || '0');
            const hasVoted = localStorage.getItem(STORAGE_KEYS.HAS_VOTED) === 'true';

            if (votedCycle !== currentCycle) {
                // New cycle - clear local vote state
                localStorage.removeItem(STORAGE_KEYS.HAS_VOTED);
                localStorage.removeItem(STORAGE_KEYS.VOTED_MECH);
                localStorage.removeItem(STORAGE_KEYS.VOTED_CYCLE);
                resetButtons();
            } else if (hasVoted) {
                const mech = localStorage.getItem(STORAGE_KEYS.VOTED_MECH);
                if (mech) lockButtons(mech);
            }
        };

        // ============================================
        // SUPABASE FUNCTIONS
        // ============================================

        // Initialize Supabase connection
        const initSupabase = async () => {
            if (SUPABASE_URL === 'https://your-project.supabase.co') {
                console.warn('Supabase not configured - using localStorage fallback');
                return false;
            }

            try {
                supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

                // Test connection by fetching current votes
                const { data, error } = await supabaseClient
                    .from('elk_votes')
                    .select('*')
                    .eq('id', 'current')
                    .single();

                if (error) {
                    if (error.code === 'PGRST116') {
                        // No row found - create initial record
                        await createInitialVoteRecord();
                    } else {
                        throw error;
                    }
                } else {
                    currentVotes = {
                        isolation: data.isolation || 0,
                        anchoring: data.anchoring || 0,
                        distraction: data.distraction || 0,
                        sublimation: data.sublimation || 0
                    };
                    currentCycle = data.cycle || 1;
                }

                // Set up real-time subscription
                setupRealtimeSubscription();

                useSupabase = true;
                updateConnectionStatus('connected');
                console.log('Supabase connected - shared voting enabled');
                return true;
            } catch (error) {
                console.error('Supabase init failed:', error);
                updateConnectionStatus('error');
                return false;
            }
        };

        // Create initial vote record in Supabase
        const createInitialVoteRecord = async () => {
            const now = new Date();
            const cycleEnd = new Date(now.getTime() + CYCLE_LENGTH_MS);

            const { error } = await supabaseClient
                .from('elk_votes')
                .insert({
                    id: 'current',
                    isolation: 0,
                    anchoring: 0,
                    distraction: 0,
                    sublimation: 0,
                    cycle: 1,
                    cycle_started_at: now.toISOString(),
                    cycle_ends_at: cycleEnd.toISOString()
                });

            if (error) throw error;
        };

        // Set up real-time subscription for live vote updates
        const setupRealtimeSubscription = () => {
            realtimeChannel = supabaseClient
                .channel('elk_votes_changes')
                .on('postgres_changes',
                    { event: '*', schema: 'public', table: 'elk_votes', filter: 'id=eq.current' },
                    (payload) => {
                        if (payload.new) {
                            currentVotes = {
                                isolation: payload.new.isolation || 0,
                                anchoring: payload.new.anchoring || 0,
                                distraction: payload.new.distraction || 0,
                                sublimation: payload.new.sublimation || 0
                            };
                            if (payload.new.cycle) currentCycle = payload.new.cycle;
                            updateVoteUI();
                            syncVoteLock();
                        }
                    }
                )
                .subscribe();
        };

        // Vote using Supabase (shared across all users)
        const voteSupabase = async (mechanism) => {
            // Use RPC function for atomic increment
            const { data, error } = await supabaseClient.rpc('increment_vote', {
                mechanism_name: mechanism
            });

            if (error) throw error;
            return data;
        };

        // ============================================
        // LOCALSTORAGE FALLBACK FUNCTIONS
        // ============================================

        const getLocalVotes = () => {
            const stored = localStorage.getItem(STORAGE_KEYS.LOCAL_VOTES);
            if (stored) {
                try {
                    return JSON.parse(stored);
                } catch (e) {}
            }
            return { isolation: 0, anchoring: 0, distraction: 0, sublimation: 0 };
        };

        const saveLocalVotes = (votes) => {
            localStorage.setItem(STORAGE_KEYS.LOCAL_VOTES, JSON.stringify(votes));
        };

        const voteLocal = (mechanism) => {
            const votes = getLocalVotes();
            votes[mechanism] = (votes[mechanism] || 0) + 1;
            saveLocalVotes(votes);
            return votes;
        };

        // ============================================
        // MAIN VOTE HANDLER
        // ============================================

        window.handleVote = async (mechanism) => {
            if (!votingEnabled) {
                showToast("VOTING UNAVAILABLE");
                return;
            }
            if (isVoting) {
                showToast("PROCESSING...");
                return;
            }
            if (!ALLOWED_MECHANISMS.includes(mechanism)) {
                showToast("INVALID MECHANISM");
                return;
            }

            // Check if already voted this cycle
            const hasVoted = localStorage.getItem(STORAGE_KEYS.HAS_VOTED) === 'true';
            const votedCycle = parseInt(localStorage.getItem(STORAGE_KEYS.VOTED_CYCLE) || '0');

            if (hasVoted && votedCycle === currentCycle) {
                showToast("ALREADY VOTED THIS CYCLE");
                return;
            }

            isVoting = true;
            showToast("VOTING...");

            try {
                if (useSupabase) {
                    // Use Supabase for shared voting
                    await voteSupabase(mechanism);
                } else {
                    // Fallback to localStorage
                    const votes = voteLocal(mechanism);
                    updateVoteUI(votes);
                }

                // Mark as voted locally (prevents double voting)
                localStorage.setItem(STORAGE_KEYS.HAS_VOTED, 'true');
                localStorage.setItem(STORAGE_KEYS.VOTED_MECH, mechanism);
                localStorage.setItem(STORAGE_KEYS.VOTED_CYCLE, String(currentCycle));

                lockButtons(mechanism);
                showToast("VOTE RECORDED");
            } catch (error) {
                console.error("Voting failed:", error);
                showToast("VOTE FAILED - RETRY");
            } finally {
                isVoting = false;
            }
        };

        // ============================================
        // INITIALIZATION
        // ============================================

        const initVoting = async () => {
            updateConnectionStatus('loading');

            // Try Supabase first
            const supabaseOk = await initSupabase();

            if (!supabaseOk) {
                // Fall back to localStorage
                console.log('Using localStorage fallback');
                currentVotes = getLocalVotes();
                updateConnectionStatus('connected');
            }

            // Update UI
            updateVoteUI();
            syncVoteLock();
        };

        // Initialize on page load - wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initVoting);
        } else {
            initVoting();
        }
        window.votingEnabled = votingEnabled;
    </script>

    <style>
        :root { --elk-crimson: rgba(139, 0, 0, 0.3); --elk-crimson-bright: rgba(220, 38, 38, 0.6); }
        html { touch-action: manipulation; -webkit-text-size-adjust: 100%; -webkit-tap-highlight-color: transparent; scroll-padding-top: 80px; }
        body { background-color: #000000; color: #e5e5e5; overflow-x: hidden; position: relative; font-family: 'Crimson Text', serif; overscroll-behavior-y: none; }
        .global-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://raw.githubusercontent.com/exelkonsol/elk/main/images/elk2.png'); background-size: cover; background-position: center; filter: grayscale(100%) opacity(0.38) contrast(1.1); z-index: -10; transform: translateZ(0); }
        .vignette { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.4) 50%, rgba(0, 0, 0, 0.95) 100%); pointer-events: none; z-index: -5; }
        .bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); pointer-events: none; z-index: -4; }
        .noise { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; opacity: 0.04; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"); }
        .blur-fade { backdrop-filter: blur(20px) saturate(180%); -webkit-backdrop-filter: blur(20px) saturate(180%); background: rgba(5, 5, 5, 0.4); border: 1px solid rgba(255, 255, 255, 0.05); }
        .buy-btn { background: var(--elk-crimson); border: 1px solid rgba(220, 38, 38, 0.3); color: rgba(255, 100, 100, 0.8); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); touch-action: manipulation; user-select: none; }
        .buy-btn:hover { background: rgba(139, 0, 0, 0.4); border-color: var(--elk-crimson-bright); color: rgba(255, 150, 150, 1); transform: translateY(-2px); box-shadow: 0 10px 40px rgba(139, 0, 0, 0.3); }
        .buy-btn:active { transform: scale(0.98); }
        .quote-section { position: relative; overflow: hidden; }
        .quote-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://raw.githubusercontent.com/exelkonsol/elk/main/images/generatewisdom.png'); background-size: cover; background-position: center; opacity: 0.25; filter: blur(0px) contrast(1.1); z-index: 0; mix-blend-mode: screen; }
        .quote-container { position: relative; z-index: 1; min-height: 500px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 4rem 1.5rem; text-align: center; }
        .quote-text { font-family: 'Crimson Text', serif; font-style: italic; font-size: clamp(1.5rem, 5vw, 2.75rem); line-height: 1.4; color: rgba(255, 255, 255, 0.95); max-width: 900px; opacity: 0; transform: translateY(10px); transition: all 0.8s ease; text-shadow: 0 4px 30px rgba(0, 0, 0, 1); margin: 2rem 0; flex: 1; display: flex; align-items: center; justify-content: center; }
        .quote-text.visible { opacity: 1; transform: translateY(0); }
        .quote-btn-group button { backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); border: 1px solid rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.5); font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; letter-spacing: 0.15em; text-transform: uppercase; cursor: pointer; transition: all 0.3s ease; touch-action: manipulation; user-select: none; min-height: 44px; min-width: 44px; display: inline-flex; align-items: center; justify-content: center; }
        .quote-btn-group button:hover { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.9); border-color: rgba(255, 255, 255, 0.3); }
        .mode-selector { display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; margin-top: 1rem; }
        .mode-btn { font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; letter-spacing: 0.2em; text-transform: uppercase; padding: 0.5rem 1rem; border: 1px solid rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.4); cursor: pointer; transition: all 0.3s ease; background: transparent; touch-action: manipulation; user-select: none; min-height: 44px; }
        .mode-btn.active { border-color: rgba(139, 0, 0, 0.5); color: rgba(255, 255, 255, 0.9); background: rgba(139, 0, 0, 0.1); }
        @keyframes materialize { 0% { opacity: 0; transform: scale(1.15) translateY(40px); filter: blur(12px); } 100% { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); } }
        .hero-content { animation: materialize 1.4s cubic-bezier(0.22, 1, 0.36, 1) forwards; will-change: transform, opacity, filter; }
        .hero-image { filter: brightness(0.9) contrast(1.05); transition: all 1.5s ease; object-fit: contain; mix-blend-mode: normal; display: block; visibility: visible; background: transparent; }
        .hero-quote-highlight { color: rgba(255, 255, 255, 0.9); font-style: italic; }
        .mechanism-card { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.04); transition: transform 0.3s ease, background-color 0.3s ease, border-color 0.3s ease; position: relative; }
        .mechanism-card:hover { background: rgba(255, 255, 255, 0.04); border-color: rgba(255, 255, 255, 0.1); transform: translateY(-4px); }
        .mechanism-card.voted { background: rgba(139, 0, 0, 0.1); border-color: rgba(139, 0, 0, 0.3); }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 100; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; padding: 1.5rem; }
        .modal-overlay.open { opacity: 1; pointer-events: auto; }
        .modal-content { background: #0a0a0a; border: 1px solid rgba(255, 255, 255, 0.1); max-width: 600px; width: 100%; padding: 2.5rem; border-radius: 8px; transform: scale(0.95) translateY(10px); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 25px 60px rgba(0, 0, 0, 0.8); max-height: 90vh; overflow-y: auto; }
        .modal-overlay.open .modal-content { transform: scale(1) translateY(0); }
        .footer-bg-layer { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; height: 100%; background-image: url('https://raw.githubusercontent.com/exelkonsol/elk/main/images/newpreview.png'); background-size: contain; background-position: center bottom; background-repeat: no-repeat; opacity: 0.15; pointer-events: none; z-index: 0; filter: grayscale(0%) contrast(1.15); }
        .audio-player-container { position: relative; overflow: hidden; container-type: inline-size; background-size: cover; background-position: center; transition: background-image 0.5s ease; filter: grayscale(30%); }
        .audio-player-container::before { content: ''; position: absolute; inset: 0; background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); z-index: 0; pointer-events: none; }
        #visualizer-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; opacity: 0.25; z-index: 1; }
        .player-grid { display: grid; gap: 2rem; grid-template-columns: 1fr; position: relative; z-index: 2; }
        @media (min-width: 768px) { .player-grid { grid-template-columns: 220px 1fr; gap: 3rem; align-items: center; } }
        @media (min-width: 1024px) { .player-grid { grid-template-columns: 260px 1fr; } }
        .vinyl-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .vinyl-record { position: relative; width: 100%; max-width: 320px; aspect-ratio: 1/1; border-radius: 50%; background: repeating-radial-gradient(circle at center, #111 0px, #111 2px, #0a0a0a 3px, #0a0a0a 4px); box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1), 0 10px 40px rgba(0, 0, 0, 0.9), inset 0 0 30px rgba(0, 0, 0, 0.9); cursor: pointer; touch-action: manipulation; transform: translateZ(0); animation: vinyl-spin 8s linear infinite; animation-play-state: paused; }
        .vinyl-record.playing { animation-play-state: running; }
        @keyframes vinyl-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .vinyl-label { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 35%; height: 35%; border-radius: 50%; background: #000; border: 2px solid rgba(139, 0, 0, 0.3); overflow: hidden; box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8); pointer-events: none; }
        .vinyl-hole { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 4%; height: 4%; border-radius: 50%; background: #000; border: 1px solid rgba(255, 255, 255, 0.2); z-index: 2; pointer-events: none; }
        .progress-container { position: relative; height: 6px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 3px; cursor: pointer; overflow: visible; touch-action: none; margin: 1rem 0; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, rgba(139, 0, 0, 0.6), rgba(255, 255, 255, 0.3)); width: 0%; position: relative; border-radius: 2px; pointer-events: none; top: -1px; height: calc(100% + 2px); transition: width 0.1s linear; }
        .progress-handle { position: absolute; right: -6px; top: 50%; transform: translateY(-50%) scale(0); width: 12px; height: 12px; background: #fff; border-radius: 50%; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); transition: transform 0.2s; pointer-events: none; }
        .progress-container:hover .progress-handle, .progress-container:active .progress-handle { transform: translateY(-50%) scale(1); }
        .track-item { transition: all 0.2s ease; border-left: 2px solid transparent; position: relative; overflow: hidden; touch-action: manipulation; min-height: 44px; display: flex; align-items: center; padding: 0.75rem 1rem; cursor: pointer; }
        .track-item:hover { background: rgba(255, 255, 255, 0.03); padding-left: 1.25rem; }
        .track-item.active { background: rgba(139, 0, 0, 0.08); border-left-color: rgba(139, 0, 0, 0.5); }
        .controls-wrapper { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 1.5rem; margin: 1.5rem 0; }
        .control-btn { transition: all 0.2s ease; touch-action: manipulation; min-height: 44px; min-width: 44px; display: inline-flex; align-items: center; justify-content: center; user-select: none; opacity: 0.6; background: transparent; border: none; color: inherit; cursor: pointer; }
        .control-btn:hover { transform: scale(1.1); opacity: 1; color: #fff; }
        .control-btn.active { opacity: 1; color: #fff; filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5)); }
        .play-btn-main { width: 64px; height: 64px; border-radius: 50%; border: 1px solid rgba(255, 255, 255, 0.3); background: rgba(255, 255, 255, 0.1); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); touch-action: manipulation; backdrop-filter: blur(4px); color: rgba(255, 255, 255, 0.9); }
        .play-btn-main:hover { background: rgba(255, 255, 255, 0.2); border-color: rgba(255, 255, 255, 0.8); transform: scale(1.05); box-shadow: 0 0 30px rgba(255, 255, 255, 0.15); }
        #mute-toggle-btn { position: fixed; bottom: 24px; right: 24px; width: 56px; height: 56px; border-radius: 50%; background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); z-index: 90; cursor: pointer; overflow: hidden; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.8); transition: transform 0.3s, border-color 0.3s; display: flex; align-items: center; justify-content: center; touch-action: manipulation; }
        #mute-toggle-btn:hover { transform: scale(1.1); border-color: rgba(255, 255, 255, 0.5); }
        #mute-toggle-btn img.btn-art { position: absolute; width: 100%; height: 100%; object-fit: cover; opacity: 0.7; pointer-events: none; animation: vinyl-spin 8s linear infinite; animation-play-state: paused; }
        #mute-toggle-btn.playing img.btn-art { animation-play-state: running; }
        @media (max-width: 640px) { .quote-container { min-height: 400px; padding: 3rem 1rem; } #mute-toggle-btn { bottom: 16px; right: 16px; width: 48px; height: 48px; } .hero-image { width: 200px !important; height: 200px !important; min-width: 200px; min-height: 200px; display: block !important; visibility: visible !important; opacity: 1 !important; } .quote-text { font-size: 1.25rem; } .vinyl-record { max-width: 240px; } .controls-wrapper { gap: 1rem; margin: 1rem 0; } .play-btn-main { width: 56px; height: 56px; } .modal-content { padding: 1.5rem; margin: 1rem; } }
        @media (pointer: coarse) { .progress-container { height: 24px; margin: -9px 0; background: transparent; border: none; } .progress-container::before { content: ''; position: absolute; top: 9px; left: 0; right: 0; height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 3px; border: 1px solid rgba(255, 255, 255, 0.1); } .progress-fill { top: 9px; height: 6px; } .progress-handle { right: -8px; width: 16px; height: 16px; transform: translateY(-50%) scale(1); } }
    </style>
</head>

<body class="font-body antialiased selection:bg-white/10 selection:text-white relative">
    <div class="noise"></div>
    <div class="global-bg"></div>
    <div class="vignette"></div>
    <div class="bg-overlay"></div>

    <div id="modal-overlay" class="modal-overlay" onclick="closeModal(event)" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-content relative" onclick="event.stopPropagation()">
            <button onclick="closeModal(null, true)" class="absolute top-4 right-4 text-white/50 hover:text-white transition-colors" aria-label="Close modal"><i data-lucide="x" class="w-6 h-6"></i></button>
            <h3 id="modal-title" class="font-serif text-2xl sm:text-3xl text-white/90 mb-4 tracking-wide"></h3>
            <div id="modal-body" class="font-body text-white/70 leading-relaxed text-base sm:text-lg space-y-4"></div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 blur-fade px-6 py-3 translate-y-full opacity-0 transition-all duration-500 z-[100] rounded-full border border-white/10 pointer-events-none">
        <span class="font-mono text-xs text-white/70 tracking-wider flex items-center gap-2"><i data-lucide="check" class="w-3 h-3"></i> <span id="toast-msg">COPIED</span></span>
    </div>

    <nav class="fixed top-0 w-full z-40 blur-fade border-b border-white/5 h-16 sm:h-20 flex items-center">
        <div class="w-full max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex justify-between items-center">
                <a href="#" class="font-serif text-base sm:text-lg font-bold tracking-[0.3em] text-white/60 hover:text-white/90 transition-colors touch-manipulation">$ELK</a>
                <div class="hidden md:flex items-center gap-8 lg:gap-12 font-mono text-[10px] tracking-[0.3em] uppercase">
                    <a href="#mechanisms" class="text-white/30 hover:text-white/70 transition-colors duration-300 py-2">Mechanisms</a>
                    <a href="#manifesto" class="text-white/30 hover:text-white/70 transition-colors duration-300 py-2">Manifesto</a>
                    <a href="#soundscape" class="text-white/30 hover:text-white/70 transition-colors duration-300 py-2">Soundscape</a>
                </div>
                <div class="flex items-center gap-3">
                    <div id="vote-status-indicator" class="w-2 h-2 rounded-full bg-yellow-500/50 animate-pulse" title="Voting Status"></div>
                    <button onclick="copyToClipboard('8DaLPxatThHR6ZMx62QtvA6vZ1oJaEKA6gWoQxjGpump', 'CA COPIED')" class="font-mono text-[9px] sm:text-[10px] text-white/60 hover:text-white/90 transition-all duration-500 tracking-wider uppercase border border-white/10 hover:border-white/30 px-3 py-2 rounded hover:bg-white/5 active:scale-95 touch-manipulation min-h-[44px]">
                        <span class="hidden sm:inline">8DaLP...Gpump</span><span class="sm:hidden">CA</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <button id="mute-toggle-btn" onclick="togglePlay()" role="button" aria-label="Toggle Play/Pause">
        <img id="btn-art" src="https://raw.githubusercontent.com/exelkonsol/elk/main/images/Before%20the%20Clearing.png" alt="Album Art" class="btn-art" decoding="async">
    </button>

    <section class="relative min-h-screen flex items-center justify-center py-20 px-4 overflow-hidden">
        <div class="hero-content relative z-10 max-w-4xl mx-auto text-center w-full flex flex-col items-center">
            <div class="mb-8 w-full flex justify-center items-center relative">
                <img id="hero-logo" src="https://raw.githubusercontent.com/exelkonsol/elk/main/images/pumpfun.png" alt="$ELK Stag" class="hero-image w-[200px] h-[200px] sm:w-[280px] sm:h-[280px] md:w-[360px] md:h-[360px] lg:w-[400px] lg:h-[400px] mx-auto object-contain select-none" loading="eager" decoding="async" fetchpriority="high">
            </div>
            <div class="space-y-6 sm:space-y-8 mb-12 sm:mb-16 max-w-4xl px-4 relative z-20">
                <p class="font-mono text-[9px] tracking-[0.4em] sm:tracking-[0.5em] text-white/20 uppercase">Peter Wessel Zapffe // On The Tragic</p>
                <h1 id="hero-quote" class="font-serif text-2xl sm:text-4xl md:text-5xl font-light text-white/60 leading-normal sm:leading-relaxed tracking-wide text-balance">"We are carried through life by a series of <span class="hero-quote-highlight">sublimations</span>—fleeting release valves for the pressure of being."</h1>
            </div>
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center items-center w-full px-8 relative z-20">
                <a href="https://pump.fun/coin/8DaLPxatThHR6ZMx62QtvA6vZ1oJaEKA6gWoQxjGpump" target="_blank" class="buy-btn w-full sm:w-auto px-8 sm:px-10 py-3 sm:py-4 text-[10px] font-mono tracking-[0.2em] uppercase text-center rounded touch-manipulation">BUY</a>
                <a href="https://x.com/i/communities/2014904566983094598" target="_blank" class="blur-fade w-full sm:w-auto px-8 sm:px-10 py-3 sm:py-4 text-[10px] font-mono tracking-[0.2em] text-white/40 hover:text-white/80 uppercase transition-all hover:scale-105 text-center rounded touch-manipulation">Join The Silence</a>
                <a href="https://birdeye.so/solana/token/8DaLPxatThHR6ZMx62QtvA6vZ1oJaEKA6gWoQxjGpump" target="_blank" class="blur-fade w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 text-[9px] font-mono tracking-[0.2em] text-white/30 hover:text-white/70 uppercase transition-all hover:scale-105 text-center rounded touch-manipulation">Chart</a>
            </div>
        </div>
    </section>

    <section id="mechanisms" class="relative py-20 sm:py-32 px-4 sm:px-6">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-16 sm:mb-20 space-y-4">
                <span class="font-mono text-[9px] tracking-[0.5em] text-white/20 uppercase block">Survival Architecture</span>
                <h2 class="font-serif text-3xl sm:text-5xl font-light text-white/50">Four Mechanisms</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
                <div class="mechanism-card p-6 sm:p-8 min-h-[320px] flex flex-col justify-between rounded-lg group" data-mechanism="isolation">
                    <div class="cursor-pointer" onclick="openModal('isolation')">
                        <div class="flex justify-between items-start mb-4"><h3 class="font-serif text-2xl text-white/70 group-hover:text-white transition-colors">Isolation</h3><i data-lucide="info" class="w-4 h-4 text-white/20 group-hover:text-white/60 transition-colors"></i></div>
                        <p class="text-white/40 text-sm leading-relaxed mb-4">Remove tokens from circulation. Confine anxiety to manageable compartments.</p>
                        <p class="text-[10px] text-white/25 font-mono uppercase tracking-wider">Suppression through reduction</p>
                    </div>
                    <div class="mt-6 pt-6 border-t border-white/5">
                        <div class="flex items-center justify-between mb-3"><span class="text-xs text-white/30 font-mono uppercase tracking-wider">Global Votes</span><span class="vote-count font-mono text-xl text-white/60" data-count="0">0</span></div>
                        <button onclick="handleVote('isolation')" class="vote-btn w-full py-3 text-[10px] font-mono tracking-wider uppercase text-white/60 hover:text-white border border-white/20 hover:border-white/50 transition-all touch-manipulation min-h-[44px] bg-transparent">Vote</button>
                    </div>
                </div>
                <div class="mechanism-card p-6 sm:p-8 min-h-[320px] flex flex-col justify-between rounded-lg group" data-mechanism="anchoring">
                    <div class="cursor-pointer" onclick="openModal('anchoring')">
                        <div class="flex justify-between items-start mb-4"><h3 class="font-serif text-2xl text-white/70 group-hover:text-white transition-colors">Anchoring</h3><i data-lucide="info" class="w-4 h-4 text-white/20 group-hover:text-white/60 transition-colors"></i></div>
                        <p class="text-white/40 text-sm leading-relaxed mb-4">Permanent liquidity. Fixed points preventing drift into the chaotic void.</p>
                        <p class="text-[10px] text-white/25 font-mono uppercase tracking-wider">Structure against entropy</p>
                    </div>
                    <div class="mt-6 pt-6 border-t border-white/5">
                        <div class="flex items-center justify-between mb-3"><span class="text-xs text-white/30 font-mono uppercase tracking-wider">Global Votes</span><span class="vote-count font-mono text-xl text-white/60" data-count="0">0</span></div>
                        <button onclick="handleVote('anchoring')" class="vote-btn w-full py-3 text-[10px] font-mono tracking-wider uppercase text-white/60 hover:text-white border border-white/20 hover:border-white/50 transition-all touch-manipulation min-h-[44px] bg-transparent">Vote</button>
                    </div>
                </div>
                <div class="mechanism-card p-6 sm:p-8 min-h-[320px] flex flex-col justify-between rounded-lg group" data-mechanism="distraction">
                    <div class="cursor-pointer" onclick="openModal('distraction')">
                        <div class="flex justify-between items-start mb-4"><h3 class="font-serif text-2xl text-white/70 group-hover:text-white transition-colors">Distraction</h3><i data-lucide="info" class="w-4 h-4 text-white/20 group-hover:text-white/60 transition-colors"></i></div>
                        <p class="text-white/40 text-sm leading-relaxed mb-4">Marketing, raids, content. Keep the mind moving against the abyss.</p>
                        <p class="text-[10px] text-white/25 font-mono uppercase tracking-wider">Motion against stillness</p>
                    </div>
                    <div class="mt-6 pt-6 border-t border-white/5">
                        <div class="flex items-center justify-between mb-3"><span class="text-xs text-white/30 font-mono uppercase tracking-wider">Global Votes</span><span class="vote-count font-mono text-xl text-white/60" data-count="0">0</span></div>
                        <button onclick="handleVote('distraction')" class="vote-btn w-full py-3 text-[10px] font-mono tracking-wider uppercase text-white/60 hover:text-white border border-white/20 hover:border-white/50 transition-all touch-manipulation min-h-[44px] bg-transparent">Vote</button>
                    </div>
                </div>
                <div class="mechanism-card p-6 sm:p-8 min-h-[320px] flex flex-col justify-between rounded-lg group" data-mechanism="sublimation">
                    <div class="cursor-pointer" onclick="openModal('sublimation')">
                        <div class="flex justify-between items-start mb-4"><h3 class="font-serif text-2xl text-white/70 group-hover:text-white transition-colors">Sublimation</h3><i data-lucide="info" class="w-4 h-4 text-white/20 group-hover:text-white/60 transition-colors"></i></div>
                        <p class="text-white/40 text-sm leading-relaxed mb-4">Transform suffering into art. Philosophy as evolutionary bypass.</p>
                        <p class="text-[10px] text-white/25 font-mono uppercase tracking-wider">Pain becomes meaning</p>
                    </div>
                    <div class="mt-6 pt-6 border-t border-white/5">
                        <div class="flex items-center justify-between mb-3"><span class="text-xs text-white/30 font-mono uppercase tracking-wider">Global Votes</span><span class="vote-count font-mono text-xl text-white/60" data-count="0">0</span></div>
                        <button onclick="handleVote('sublimation')" class="vote-btn w-full py-3 text-[10px] font-mono tracking-wider uppercase text-white/60 hover:text-white border border-white/20 hover:border-white/50 transition-all touch-manipulation min-h-[44px] bg-transparent">Vote</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="manifesto" class="relative py-20 sm:py-32 px-4 sm:px-6">
        <div class="max-w-5xl mx-auto">
            <div class="quote-section blur-fade rounded-xl border border-white/5 overflow-hidden">
                <div class="quote-bg"></div>
                <div class="quote-container">
                    <div class="mb-6 w-full text-center relative z-10"><p class="font-mono text-[9px] tracking-[0.4em] text-white/30 uppercase">Echoes of the Present Void</p></div>
                    <div class="mode-selector mb-8 relative z-10">
                        <button class="mode-btn active" onclick="setMode('existential', this)" aria-pressed="true">Existential</button>
                        <button class="mode-btn" onclick="setMode('degen', this)" aria-pressed="false">Degen</button>
                        <button class="mode-btn" onclick="setMode('elk', this)" aria-pressed="false">Elk Wisdom</button>
                    </div>
                    <div id="quote-display" class="quote-text visible px-4 relative z-10">"We built machines to save time, and now we kill time staring at them, waiting for something to happen."</div>
                    <div class="quote-btn-group mt-auto flex gap-4 relative z-10">
                        <button onclick="generateQuote()" class="px-8 py-3 hover:bg-white/5 rounded border border-white/10 hover:border-white/30 uppercase tracking-widest text-[10px] transition-all active:scale-95 touch-manipulation min-h-[44px]">Generate Echo</button>
                        <button onclick="copyQuote()" class="px-4 py-3 hover:bg-white/5 rounded border border-white/10 hover:border-white/30 text-white/50 hover:text-white transition-all active:scale-95 touch-manipulation min-h-[44px] min-w-[44px]" aria-label="Copy Quote"><i data-lucide="copy" class="w-4 h-4"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="soundscape" class="relative py-20 sm:py-32 px-4 sm:px-6 min-h-[800px] overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/20 to-black/50 pointer-events-none"></div>
        <div class="max-w-5xl mx-auto h-full flex flex-col relative z-10">
            <div class="text-center mb-12 sm:mb-20 space-y-4">
                <span class="font-mono text-[9px] tracking-[0.5em] text-white/10 uppercase block">Auditory Space</span>
                <h2 class="font-serif text-3xl sm:text-5xl font-light text-white/50">HYMNS FOR THE HERD</h2>
            </div>
            <div id="audio-interface" class="audio-player-container blur-fade p-6 sm:p-10 rounded-xl border border-white/5 relative bg-black/60">
                <canvas id="visualizer-canvas"></canvas>
                <div class="player-grid relative z-10">
                    <div class="vinyl-wrapper">
                        <div class="vinyl-record" id="vinyl-disc" onclick="togglePlay()" role="button" aria-label="Play/Pause">
                            <div class="vinyl-label"><img id="album-art-small" src="" alt="" class="w-full h-full object-cover opacity-80" decoding="async"></div>
                            <div class="vinyl-hole"></div>
                        </div>
                        <div class="mt-6 text-center"><div id="track-status" class="font-mono text-[9px] tracking-widest text-white/30 uppercase">Paused</div></div>
                    </div>
                    <div class="flex flex-col h-full justify-center space-y-6 w-full">
                        <div class="text-center md:text-left min-h-[60px]">
                            <h3 id="track-title" class="font-serif text-xl sm:text-2xl text-white/80 mb-1 leading-tight truncate">Before the Clearing</h3>
                            <p id="track-desc" class="text-white/30 text-xs sm:text-sm italic truncate">"The silence before revelation"</p>
                        </div>
                        <div class="space-y-2">
                            <div class="progress-container" id="progress-container" role="slider" aria-label="Seek" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
                                <div class="progress-fill" id="progress-fill"><div class="progress-handle"></div></div>
                            </div>
                            <div class="flex justify-between text-[10px] font-mono text-white/30"><span id="time-current">00:00</span><span id="time-total">00:00</span></div>
                        </div>
                        <div class="controls-wrapper">
                            <button onclick="toggleShuffle()" id="shuffle-btn" class="control-btn text-white/60" aria-label="Shuffle"><i data-lucide="shuffle" class="w-5 h-5"></i></button>
                            <button onclick="prevTrack()" class="control-btn text-white/80" aria-label="Previous"><i data-lucide="skip-back" class="w-7 h-7"></i></button>
                            <button onclick="togglePlay()" id="play-btn" class="play-btn-main" aria-label="Play/Pause"><i data-lucide="play" id="play-icon" class="w-6 h-6 ml-1"></i></button>
                            <button onclick="nextTrack()" class="control-btn text-white/80" aria-label="Next"><i data-lucide="skip-forward" class="w-7 h-7"></i></button>
                            <button onclick="toggleRepeat()" id="repeat-btn" class="control-btn text-white/60" aria-label="Repeat"><i data-lucide="repeat" class="w-5 h-5"></i></button>
                        </div>
                        <div class="flex-1 overflow-y-auto max-h-48 space-y-1 pr-2 custom-scrollbar border-t border-b border-white/5 py-2" id="playlist"></div>
                        <div class="flex items-center gap-3 px-2 pt-2"><i data-lucide="volume-2" class="w-4 h-4 text-white/30"></i><input type="range" min="0" max="100" value="60" class="flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white/30 hover:accent-white/50" oninput="setVolume(this.value)" aria-label="Volume"></div>
                    </div>
                </div>
                <audio id="audio-player" preload="metadata" crossorigin="anonymous" playsinline webkit-playsinline></audio>
            </div>
        </div>
    </section>

    <footer class="relative py-16 sm:py-24 px-6 border-t border-white/5 bg-black overflow-hidden">
        <div class="footer-bg-layer"></div>
        <div class="relative z-10 max-w-2xl mx-auto text-center space-y-10">
            <blockquote class="font-body text-white/50 text-sm sm:text-base leading-relaxed italic px-4">"The tragedy of man is that he is constituted to strive for goals he can never fully attain, and to seek answers he can never fully comprehend."</blockquote>
            <div class="flex justify-center gap-10">
                <a href="https://github.com/exelkonsol/elk" target="_blank" class="text-white/20 hover:text-white/60 transition-colors duration-300 hover:scale-110 touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center" aria-label="GitHub"><i data-lucide="github" class="w-5 h-5"></i></a>
                <a href="https://x.com/ElkBurden" target="_blank" class="text-white/20 hover:text-white/60 transition-colors duration-300 hover:scale-110 touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center" aria-label="Twitter"><i data-lucide="twitter" class="w-5 h-5"></i></a>
                <a href="https://birdeye.so/solana/token/8DaLPxatThHR6ZMx62QtvA6vZ1oJaEKA6gWoQxjGpump" target="_blank" class="text-white/20 hover:text-white/60 transition-colors duration-300 hover:scale-110 touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center" aria-label="Chart"><i data-lucide="activity" class="w-5 h-5"></i></a>
            </div>
            <p class="font-mono text-[9px] text-white/30 tracking-[0.4em] uppercase">The Antlers Are Heavy // We Carry Them Together</p>
        </div>
    </footer>

    <script>
        if (history.scrollRestoration) history.scrollRestoration = 'manual';
        lucide.createIcons();

        // Hero logo fallback for mobile
        (function() {
            const heroLogo = document.getElementById('hero-logo');
            if (heroLogo) {
                heroLogo.onerror = function() {
                    // Retry with cache-busting
                    this.src = 'https://raw.githubusercontent.com/exelkonsol/elk/main/images/pumpfun.png?' + Date.now();
                };
                // Force reload on mobile if image appears broken
                if (heroLogo.complete && heroLogo.naturalHeight === 0) {
                    heroLogo.src = 'https://raw.githubusercontent.com/exelkonsol/elk/main/images/pumpfun.png?' + Date.now();
                }
            }
        })();

        function showToast(msg) {
            const t = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            t.classList.remove('translate-y-full', 'opacity-0');
            if (navigator.vibrate) navigator.vibrate(10);
            setTimeout(() => t.classList.add('translate-y-full', 'opacity-0'), 2500);
        }

        function copyToClipboard(text, msg) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => showToast(msg)).catch(() => fallbackCopy(text, msg));
            } else {
                fallbackCopy(text, msg);
            }
        }

        function fallbackCopy(text, msg) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.cssText = "position:fixed;left:-9999px;opacity:0";
            document.body.appendChild(textArea);
            textArea.select();
            try { document.execCommand('copy'); showToast(msg); } catch (err) { console.error('Copy failed', err); }
            document.body.removeChild(textArea);
        }

        const heroQuotes = [
            { text: "Isolation is the quiet architecture where the mind hides its failures.", mechanism: "isolation" },
            { text: "We survive by Isolation, a narrowing that turns chaos into a room.", mechanism: "isolation" },
            { text: "Anchoring is the weight that keeps the herd from drifting into noise.", mechanism: "anchoring" },
            { text: "We trust Anchoring when every other signal fades.", mechanism: "anchoring" },
            { text: "Distraction is the wheel that keeps turning so the void cannot speak.", mechanism: "distraction" },
            { text: "We choose Distraction because stillness tells the truth.", mechanism: "distraction" },
            { text: "Sublimation is the climb that turns pain into a signal flare.", mechanism: "sublimation" },
            { text: "We practice Sublimation when suffering becomes a ladder instead of a pit.", mechanism: "sublimation" }
        ];

        function renderHeroQuote() {
            const target = document.getElementById('hero-quote');
            if (!target) return;
            const choice = heroQuotes[Math.floor(Math.random() * heroQuotes.length)];
            const pattern = new RegExp(`\\b(${choice.mechanism})\\b`, 'i');
            target.innerHTML = `"${choice.text.replace(pattern, '<span class="hero-quote-highlight">$1</span>')}"`;
        }
        renderHeroQuote();

        const modalContent = {
            isolation: {
                title: "Isolation",
                body: `<p>Isolation is the deliberate thinning of noise—the conscious decision to wall off disturbing thoughts and reduce the overwhelming complexity of existence to manageable fragments. In Zapffe's philosophy, isolation functions as a psychological defense mechanism where we compartmentalize the unbearable truths about our condition.</p>
                <p class="mt-4">Within the $ELK ecosystem, isolation manifests through token burns and supply reduction. By removing tokens from circulation, we compress the system until only what matters remains. This scarcity reflects the deeper fear of nothingness—the void we desperately try to avoid confronting.</p>
                <p class="mt-4">Just as the mind isolates traumatic knowledge into inaccessible compartments, the tokenomics of isolation create artificial scarcity that mirrors our psychological need to limit what we must carry. The burn is not destruction—it is selective forgetting, a mercy we grant ourselves.</p>
                <p class="mt-4 text-white/40 text-sm italic">\"We survive by refusing to see the whole picture.\"</p>`
            },
            anchoring: {
                title: "Anchoring",
                body: `<p>Anchoring is the mechanism by which we attach ourselves to fixed points in a reality that offers none. Zapffe understood that humans require stable reference points—values, beliefs, routines—to prevent the vertiginous drift into cosmic meaninglessness.</p>
                <p class="mt-4">In the $ELK framework, anchoring takes the form of permanent liquidity and locked pools. These immutable structures serve as gravitational centers, preventing the community from scattering into the chaotic void of speculation. The locked liquidity is our covenant with stability.</p>
                <p class="mt-4">When everything is uncertain, when markets crash and narratives collapse, the anchor remains. It is the fixed star by which we navigate, even knowing that all stars eventually burn out. Anchoring does not deny the void—it simply refuses to look down while crossing the abyss.</p>
                <p class="mt-4">The weight of anchoring keeps us grounded when lighter minds would float away into delusion or despair. Structure against entropy. Order against chaos. A stake driven into shifting sand.</p>
                <p class="mt-4 text-white/40 text-sm italic">\"We build monuments not because they will last, but because building them gives us something to hold.\"</p>`
            },
            distraction: {
                title: "Distraction",
                body: `<p>Distraction is motion as mercy—the perpetual activity that prevents the mind from settling into contemplation of its own predicament. Zapffe recognized that humanity fills every silence with noise, every pause with action, because stillness invites the awareness we cannot bear.</p>
                <p class="mt-4">For $ELK, distraction manifests as marketing campaigns, community raids, meme creation, and the endless production of content. These activities are not merely promotional—they are existential. The raid is a ritual. The meme is a prayer. Each post is a small rebellion against the silence.</p>
                <p class="mt-4">We do not create content because we believe it will change our fate. We create it because the act of creation keeps the abyss at bay for another moment. The chart may bleed red, but if we are busy enough, we do not have to watch it.</p>
                <p class="mt-4">Distraction is not denial—it is strategic avoidance. The community that moves together survives together, not because movement solves anything, but because it postpones the reckoning.</p>
                <p class="mt-4 text-white/40 text-sm italic">\"We fill the void with noise because the void's silence tells us too much.\"</p>`
            },
            sublimation: {
                title: "Sublimation",
                body: `<p>Sublimation is the highest of Zapffe's mechanisms—the transformation of suffering into something greater. Where isolation hides, anchoring steadies, and distraction averts, sublimation transmutes. It takes the raw material of existential pain and forges it into art, philosophy, community, and meaning.</p>
                <p class="mt-4">Within $ELK, sublimation is the philosophical foundation itself. The project transforms the brutal realities of memecoin speculation—the losses, the volatility, the absurdity—into a shared mythology. We do not deny the suffering; we make it sacred.</p>
                <p class="mt-4">Every piece of art created from market pain, every philosophical reflection born from a red portfolio, every moment of genuine community forged in shared hardship—this is sublimation in action. The burden becomes the badge. The weight becomes the wings.</p>
                <p class="mt-4">Zapffe believed that sublimation was rare because it requires both the courage to face the void and the creative capacity to build bridges across it. The elk carries antlers not despite their weight, but because of it. The burden, properly sublimated, becomes the very thing that elevates us above mere survival.</p>
                <p class="mt-4 text-white/40 text-sm italic">\"Pain becomes meaning when we refuse to let it be meaningless.\"</p>`
            }
        };

        function openModal(mech) {
            const data = modalContent[mech];
            if (!data) return;
            document.getElementById('modal-title').textContent = data.title;
            document.getElementById('modal-body').innerHTML = data.body;
            document.getElementById('modal-overlay').classList.add('open');
            document.body.style.overflow = 'hidden';
            lucide.createIcons();
        }

        function closeModal(e, force = false) {
            if (force || (e && e.target.id === 'modal-overlay')) {
                document.getElementById('modal-overlay').classList.remove('open');
                document.body.style.overflow = '';
            }
        }

        // FULL DATABASE: 600+ Quotes Total
        const quotesExistential = [
            "We built machines to save time, and now we kill time staring at them, waiting for something to happen.", "Man is the only animal that refuses to be what he is.", "Anxiety is the dizziness of freedom.", "To live is to suffer, to survive is to find some meaning in the suffering.", "He who has a why to live can bear almost any how.", "We are condemned to be free.", "Existence precedes essence.", "The struggle itself towards the heights is enough to fill a man's heart.", "One must imagine Sisyphus happy.", "Hell is other people.", "Life has no meaning a priori. It is up to you to give it meaning.", "In the depth of winter, I finally learned that within me there lay an invincible summer.", "The absurd is born of this confrontation between the human need and the unreasonable silence of the world.",
            "There is but one truly serious philosophical problem, and that is suicide.", "Man is nothing else but what he purposes, he exists only in so far as he realizes himself.", "Freedom is what you do with what's been done to you.", "We are our choices.", "Life is a preparation for the future; and the best preparation for the future is to live as if there were none.", "The only way to deal with an unfree world is to become so absolutely free that your very existence is an act of rebellion.", "The mass of men lead lives of quiet desperation.", "We are all in the gutter, but some of us are looking at the stars.", "Nothing matters very much, and most things don't matter at all.", "The cure for pain is in the pain.", "To be conscious is to be sick.", "The eternal silence of these infinite spaces frightens me.", "Every existing thing is born without reason, prolongs itself out of weakness, and dies by chance.",
            "The meaning of life is that it stops.", "We are born alone, we live alone, we die alone. Only through our love and friendship can we create the illusion for a moment that we're not alone.", "The fear of death follows from the fear of life. A man who lives fully is prepared to die at any time.", "Nobody realizes that some people expend tremendous energy merely to be normal.", "You will never be happy if you continue to search for what happiness consists of.", "There is no fate that cannot be surmounted by scorn.", "Should I kill myself, or have a cup of coffee?", "The pessimist resembles a man who observes with fear and sadness that his wall calendar, from which he daily tears a sheet, grows thinner with each passing day.", "Optimism is merely the symptom of a cowardly, mean, and so to speak, brazenly provincial spirit.", "The world is my idea.", "Life is a constant process of dying.", "A novel is never anything but a philosophy put into images.",
            "The consciousness of the nothingness of our being is the heaviest burden we carry.", "Thoughts are the shadows of our feelings, always darker, emptier, and simpler.", "God is dead! He remains dead! And we have killed him.", "What does not kill me, makes me stronger.", "When you look into an abyss, the abyss also gazes into you.", "He who fights with monsters might take care lest he thereby become a monster.", "The advantage of a bad memory is that one enjoys several times the same good things for the first time.", "It is hard enough to remember my opinions, without also remembering my reasons for them.", "There are no facts, only interpretations.", "That which does not kill us makes us stronger.", "Without music, life would be a mistake.", "The thought of suicide is a great consolation: by means of it one gets successfully through many a bad night.", "In individuals, insanity is rare; but in groups, parties, nations and epochs, it is the rule.",
            "The man of knowledge must be able not only to love his enemies but also to hate his friends.", "A good writer possesses not only his own spirit but also the spirit of his friends.", "Art is the proper task of life.", "We have art in order not to die of the truth.", "The future influences the present just as much as the past.", "All things are subject to interpretation whichever interpretation prevails at a given time is a function of power and not truth.", "The most common lie is that which one lies to himself; lying to others is relatively an exception.", "The individual has always had to struggle to keep from being overwhelmed by the tribe.", "That which is done out of love is always beyond good and evil.", "There is always some madness in love. But there is also always some reason in madness.", "The surest way to corrupt a youth is to instruct him to hold in higher esteem those who think alike than those who think differently.", "Every deep thinker is more afraid of being understood than of being misunderstood.",
            "The free soul is rare, but you know it when you see it—basically because you feel good, very good, when you are near or with them.", "The problem with the world is that the intelligent people are full of doubts, while the stupid ones are full of confidence.", "Find what you love and let it kill you.", "Sometimes you climb out of bed in the morning and you think, I'm not going to make it, but you laugh inside—remembering all the times you've felt that way.", "We are here to laugh at the odds and live our lives so well that Death will tremble to take us.", "The less I needed, the better I felt.", "People are strange: They are constantly angered by trivial things, but on a major matter like totally wasting their lives, they hardly seem to notice.", "Dying is an art, like everything else. I do it exceptionally well.", "I took a deep breath and listened to the old brag of my heart. I am, I am, I am.", "How wonderful it is that nobody need wait a single moment before starting to improve the world.", "Life is never fair, and perhaps it is a good thing for most of us that it is not.",
            "The only way to survive eternity is to be able to appreciate each moment.", "Time is a drug. Too much of it kills you.", "Humans are the only animals that blush, or need to.", "The only thing worse than being blind is having sight but no vision.", "We are what we pretend to be, so we must be careful about what we pretend to be.", "Of all the words of mice and men, the saddest are, 'It might have been.'", "We are trapped in the belly of this horrible machine, and the machine is bleeding to death.", "I don't want to die without any scars.", "The saddest aspect of life right now is that science gathers knowledge faster than society gathers wisdom.", "We are not human beings having a spiritual experience. We are spiritual beings having a human experience.", "The greatest discovery of any generation is that a human can alter his life by altering his attitude.", "We cannot solve our problems with the same thinking we used when we created them.", "Reality is merely an illusion, albeit a very persistent one.",
            "The important thing is not to stop questioning. Curiosity has its own reason for existing.", "A person who never made a mistake never tried anything new.", "Life is like riding a bicycle. To keep your balance, you must keep moving.", "The most beautiful experience we can have is the mysterious.", "I have no special talent. I am only passionately curious.", "Try not to become a man of success. Rather become a man of value.", "The world as we have created it is a process of our thinking. It cannot be changed without changing our thinking.", "If you can't explain it to a six year old, you don't understand it yourself.", "I speak to everyone in the same way, whether he is the garbage man or the president of the university.", "Never memorize something that you can look up.", "Whoever is careless with the truth in small matters cannot be trusted with important matters.", "We experience moments absolutely free from worry. These brief respites are called panic.", "The optimist thinks this is the best of all possible worlds. The pessimist fears it is true.",
            "In the end, we all die. The question is what we lived for.", "The only true wisdom is in knowing you know nothing.", "An unexamined life is not worth living.", "The only thing I know is that I know nothing.", "Wonder is the beginning of wisdom.", "The greatest wealth is to live content with little.", "There is only one good, knowledge, and one evil, ignorance.", "Be kind, for everyone you meet is fighting a hard battle.", "Strong minds discuss ideas, average minds discuss events, weak minds discuss people.", "We can easily forgive a child who is afraid of the dark; the real tragedy of life is when men are afraid of the light.", "The silence between thoughts is where truth resides.", "We are all temporarily abled.", "The future is certain; it is the past that is unpredictable.", "To be human is to be a question without an answer.", "We are all lottery winners of existence, yet we complain about the prize.", "Life is a maze in which we are all simultaneously the mouse and the walls.",
            "The weight of existence is measured in unfulfilled possibilities.", "We are echoes of a bang that forgot its own cause.", "Consciousness is nature's mistake.", "The end is built into the beginning.", "We are all bridges between nowhere and nowhere.", "Life is the art of drawing sufficient conclusions from insufficient premises.", "The void is not empty; it is full of answers to questions we dare not ask.", "We are the glitch in the universal matrix.", "Time heals nothing; it just replaces one pain with another.", "The only authentic life is one that embraces its own absurdity.", "We are all astronauts on a rock ship.", "Birth is the first and most fatal tragedy.", "To exist is to be drafted into a war without enemy or objective.", "We are shadows of thoughts that never materialized.", "Life is a banquet, and most poor suckers are starving to death.", "The universe expands while we contract.", "We are all drowning, but some of us have learned to breathe underwater.", "Meaning is a human invention, like time zones and tax codes.",
            "The present moment is the only reality, yet we flee from it constantly.", "We are the ghosts of our future regrets.", "Existence is plagiarism; we copy lives hoping to find an original.", "The mirror shows us what we are, not who we are.", "We are all temporary custodians of carbon.", "Life is a joke told at our expense.", "The stars are indifferent witnesses to our insignificance.", "We are running out of time to realize we never had time.", "Being is the catastrophe.", "We are the question the universe asks itself when it cannot sleep.", "The path is made by walking, but we walk in circles.", "Life is a terminal condition diagnosed at birth.", "We are all artists painting over the cracks in reality.", "The silence of the infinite spaces kills us softly.", "To be conscious is to wear a crown of thorns made of neurons.", "We are the glitch that evolution couldn't patch.", "Time is a predator that stalks us all.", "Existence is a debt we pay with suffering.", "We are all tourists in our own lives.", "The abyss is not below us; it is within us.",
            "Life is a first draft written in disappearing ink.", "We are the survivors of a suicide we committed yesterday.", "The cosmos is indifferent, but the room is freezing.", "To exist is to leave a trace, however faint.", "We are all prisoners of the present tense.", "Meaning is a sandcastle built against the tide of entropy.", "The clock ticks in a language we forgot how to speak.", "We are the breadcrumbs left by a god who got lost.", "Life is a rehearsal for a premiere that keeps getting postponed.", "The void is not the enemy; certainty is.", "We are all astronauts of the interior.", "Existence is a slow-motion explosion.", "To be is to be vulnerable.", "We are the museum exhibits of a civilization that hasn't happened yet.", "The weight of being is measured in grams of consciousness.", "Life is a match struck in a hurricane.", "We are the punctuation marks in a sentence written by chaos.", "The future is a memory we haven't had yet.", "To exist is to be audited by infinity.", "We are all walking paradoxes dressed in skin.", "The universe doesn't know we exist, and that is our freedom.",
            "Life is a scribble on the bathroom wall of eternity.", "We are the pause between two notes of silence.", "Being is the original sin.", "We are all cartographers mapping a territory that shifts beneath our feet.", "The present is a knife edge we balance upon.", "Existence is a loan we repay with non-existence.", "We are the dreams of a sleeping god who must never wake.", "Time is the fire in which we burn.", "To live is to be exposed.", "We are the leftovers of the Big Bang's dinner party.", "Life is a typo in the book of nothingness.", "The abyss looks back with our own eyes.", "We are all tightrope walkers without a net.", "Meaning is a muscle that atrophies without use.", "The silence between heartbeats is where truth hides.", "We are the appendix of the cosmic body.", "Existence is a test with no questions and no time limit.", "To be human is to be a work in progress that never ships.", "We are all archaeologists digging through the layers of our own dust.", "The stars are dead but their light lives on—a metaphor for hope or futility, depending on the hour.",
            "Life is a sentence served in the prison of the skull.", "We are the static between stations on the universal radio.", "The void is patient; it can wait.", "Being is the act of holding one's breath forever.", "We are all fictional characters in search of an author.", "Time is a maze with no exit, only corridors that look like progress.", "Existence is the art of pretending the floor isn't lava.", "We are the noise the universe makes when it is lonely.", "To exist is to be incomplete.", "Life is a rough draft written by a committee of one.", "The mirror is the only witness to our solitude.", "We are all time travelers moving at the speed of now.", "The weight of the world is exactly equal to the weight of our attention.", "Consciousness is a lighthouse warning ships that will never come.", "We are the fossils of the future.", "Being is the long way around to non-being.", "The universe is silent, and in that silence, we hear ourselves.", "We are all jugglers keeping too many balls in the air.", "Life is a spoiler for the ending we all know is coming.", "To be is to be on fire and pretend it is warmth.",
            "We are the parentheses in the equation of existence.", "The abyss is just another word for Monday morning.", "Existence is a feedback loop of desire and disappointment.", "We are all satellites transmitting into the void, hoping for a signal back.", "Time is the currency we spend without knowing the exchange rate.", "The self is a story we tell to keep the darkness company.", "We are the ashes pretending we remember the fire.", "Life is a preview of coming attractions nobody ordered.", "To exist is to be the ghost and the haunted house.", "We are all tightropes stretched between two graves.", "The universe expands; we contract.", "Being is the original glitch in the matrix of nothingness.", "We are the questions that the stars forgot to ask.", "Silence is the only language that tells the truth.", "Existence is a debt paid in installments of awareness.", "We are all archaeologists of our own imminent ruin.", "The clock is a conspiracy to make us think we're late.", "To be is to be perpetually unfinished.", "We are the fog on the mirror of reality.", "Life is a rough cut of a film that will never premiere.", "The void is just home wearing a mask."
        ];

        const quotesDegen = [
            "Buy high, sell low, cry in the shower.", "My portfolio is red, my eyes are too.", "Sleep is for those without leverage.", "I checked the chart 400 times today, nothing changed but my sanity.", "WAGMI is a lie we tell ourselves to keep holding.", "Diamond hands? More like heavy bags.", "I'm in it for the tech (I'm down 90%).", "Liquidation emails are my morning alarm.", "Just one more pump, I promise I'll exit.", "The devs did something... they sold.", "Sir, your bags are leaking.", "My therapist accepts Solana now.", "I sold the bottom and bought the top, perfectly balanced.", "NGMI is not a state of mind, it's a lifestyle.", "The chart looks like my EKG after my third energy drink.", "I'm not panicking, I'm just aggressively long-term holding.", "My entry point is a distant memory, like my sanity.", "The community is strong because nobody can afford to leave.", "I diversified by buying different shades of red candles.", "My financial advisor blocked my number.", "The dev is active... in the Maldives.", "I'm a hodler, not a trader. Mostly because I don't know how to sell.", "My bags have bags.", "The only green I see is when I close my eyes.", "I'm early to the next cycle, or late to the last one.",
            "My portfolio is a modern art piece titled 'Regret'.", "I have a PhD in buying the top.", "My liquidation price is my sleep paralysis demon.", "I don't always check the chart, but when I do, it's red.", "I told my mom I trade crypto. She thinks I'm a drug dealer.", "My wallet is like a black hole, but for money.", "I'm not losing money, I'm investing in experience points.", "The only thing pumping is my blood pressure.", "I have diamond hands and paper lungs from all the screaming.", "My strategy is buy high, never sell, die young.", "I'm in a committed relationship with my unrealized losses.", "My portfolio is diversified between zero and nothing.", "I don't need sleep, I need a 10x.", "My average down strategy has brought me to the center of the Earth.", "I'm not a degenerate, I'm a sophisticated risk manager.", "My bank account is a horror story I tell my children.", "I bought the dip, then it dipped more.", "My bags are so heavy I need a chiropractor.", "I'm not crying, it's just liquidated tears.", "My trading strategy is autism powered by caffeine.", "I'm bullish on ramen noodles for the next year.", "My ROI is Return On Ignorance.",
            "I don't check the price, I check my will to live.", "My portfolio is a testament to the Dunning-Kruger effect.", "I'm not a bag holder, I'm a long-term value investor with a 99% discount.", "My wallet is where good money goes to die.", "I have two moods: euphoria and existential dread.", "My trading journal reads like a suicide note.", "I don't need a rug pull, I pull my own rug by making bad trades.", "My cost basis is higher than my self-esteem.", "I'm not fomoing, I'm strategically entering at market peaks.", "My portfolio is proof that evolution can work backwards.", "I don't need a financial advisor, I need an exorcist.", "My bags are so heavy they're affecting Earth's rotation.", "I'm not a degenerate gambler, I'm a blockchain enthusiast.", "My wallet is a museum of bad decisions.", "I don't buy the dip, I marry it.", "My portfolio is a black mirror episode that never ends.", "I'm not losing money, I'm donating to the whales.", "My trading strategy is powered by hope and delusion.", "I don't need technical analysis, I need technical therapy.", "My bags are so red they're shifting the color spectrum.",
            "I'm not a day trader, I'm a decade bag holder.", "My portfolio is a charity for anonymous developers.", "I don't check PnL, I check my pulse.", "My wallet is a graveyard of promising projects.", "I'm not early, I'm catastrophically premature.", "My average buy price is a number that haunts my dreams.", "I don't need stop losses, I need stop existing.", "My portfolio is a masterclass in Murphy's Law.", "I'm not trading, I'm just collecting expensive screenshots.", "My bags are so heavy they have their own gravity.", "I don't buy coins, I adopt digital orphans.", "My trading history is a crime scene.", "I'm not a whale, I'm plankton in a whale's digestive system.", "My portfolio diversification means buying different shades of red.", "I don't need a ledger, I need a therapist.", "My bags are like my ex, they keep going down.", "I'm not investing, I'm performing an elaborate money burning ritual.", "My wallet is where hope goes to suffocate.", "I don't chase pumps, I chase my losses into the abyss.", "My portfolio is a visual representation of chaos theory.", "I'm not a degen, I'm a liquidity provider for smart money exits.", "My bags are so old they're getting historical landmark status.",
            "I don't need charts, I need tarot cards.", "My trading plan is written on a cocktail napkin in crayon.", "I'm not down bad, I'm down catastrophic.", "My portfolio is a warning tale parents tell their children.", "I don't buy signals, I buy into my own delusions.", "My bags are the only thing heavier than my existential dread.", "I'm not a crypto investor, I'm a professional donation machine.", "My wallet balance is a number that makes mathematicians cry.", "I don't need a bull run, I need a miracle.", "My portfolio is an avant-garde performance art piece about loss.", "I'm not holding bags, I'm holding the weight of my mistakes.", "My trading career is a speedrun to financial ruin.", "I don't need fundamentals, I need fundamental help.", "My bags are so deep they're in the Mariana Trench.", "I'm not a retail investor, I'm a professional exit liquidity provider.", "My portfolio is a love letter to financial devastation.", "The chart is forming a 'descending into madness' pattern.", "I'm not losing money, I'm investing in experience points.", "My wife's boyfriend says I should buy more.", "The dev updated the website... with a 'gone fishing' sign.", "I'm leveraged 50x on hope.",
            "My cost basis is a work of fiction.", "The community is tight-knit because we're all trapped in the same burning building.", "I bought the rumor, sold the news, bought the lawsuit.", "My trading strategy is 'thoughts and prayers'.", "The only thing pumping is my blood pressure.", "I'm a crypto veteran... of three months.", "My portfolio is diversified between rugs and slow rugs.", "The dev said 'trust me'—famous last words.", "I'm not crying, I'm just leaking value.", "My wallet is a museum of bad decisions.", "The chart is forming a beautiful 'L' for 'loser'.", "I have a strong hand... because I can't find the sell button.", "My financial plan is 'number go up eventually'.", "The only thing decentralized is my losses.", "I'm a liquidity provider... for whales.", "My bags are so heavy I need a forklift.", "The dev is doxxed... as a cartoon animal.", "I'm not FOMOing, I'm just strategically buying high.", "My portfolio is a testament to the impermanence of wealth.", "The community is amazing... at coping.", "I bought the dip, then it dipped more.", "My trading strategy is 'buy and pray'.", "The chart looks like a ski slope designed by M.C. Escher.", "I'm a long-term investor... because I can't afford to be a short-term one.",
            "My bags are vintage... from last week.", "The dev said the contract is safe... from auditors.", "I'm not down bad, I'm up good at losing.", "My wallet is a black hole for disposable income.", "The only thing going to the moon is my stress level.", "I'm a crypto maximalist... of pain.", "My portfolio is a roller coaster with no safety bars.", "The dev renamed the project... three times today.", "I'm not rekt, I'm just experiencing negative growth.", "My bags are so heavy they have their own gravitational pull.", "The community is engaged... in civil war.", "I bought the top, sold the bottom, bought the lawsuit.", "My financial advisor is a Magic 8-Ball that only says 'Outlook not so good'.", "The chart is forming a 'descending into the earth's core' pattern.", "I'm a diamond hand... because my hands are frozen in terror.", "My portfolio is a testament to the Dunning-Kruger effect.", "The dev said 'we're building'... sandcastles.", "I'm not gambling, I'm participating in high-volatility savings.", "My bags are premium... at a 99% discount.", "The only thing decentralized is my sense of reality.", "I'm a crypto pioneer... of new ways to lose money.", "My wallet is a graveyard of abandoned projects.", "The chart looks like my life... consistently disappointing.",
            "I'm hodling... because the sell button is broken.", "My financial strategy is 'it can't go lower' (it can).", "The community is strong... in their delusion.", "I bought the rumor, sold the news, bought the dip, sold the bankruptcy.", "My portfolio is a modern tragedy in four acts.", "The dev said 'we're in this together'... in the life raft, while I'm on the Titanic.", "I'm not desperate, I'm just aggressively optimistic.", "My bags are so heavy they broke the blockchain.", "The only thing green is my envy of people who sold.", "I'm a liquidity crisis with a Twitter account.", "My trading history is a cautionary tale.", "The chart is forming a 'surrender cobra' pattern.", "I'm not poor, I'm just illiquid... permanently.", "My portfolio is a shrine to the god of bad timing.", "The dev said 'gm'... from prison.", "I'm a bagholder, not a trader. It's not a choice, it's a sentence.", "My wallet is an ouroboros of bad decisions.", "The community is vibrant... with panic.", "I bought the dip, then the dip bought me.", "My financial plan is 'maybe a celebrity will tweet about it'.", "The chart looks like a heartbeat... of a dying man.", "I'm leveraged on dreams and margin called by reality.", "My bags are heirloom quality... passed down from my previous bad trade.",
            "The dev said 'utility coming soon'... in 2021.", "I'm not coping, I'm just performing advanced mental gymnastics.", "My portfolio is a black mirror episode.", "The only thing pumping is my tolerance for pain.", "I'm a crypto enthusiast... of suffering.", "My wallet is a donation box for smart contract developers.", "The chart is forming a 'laughing through tears' pattern.", "I'm not down, I'm just participating in a bear market... permanently.", "My bags are so heavy I need emotional support.", "The community is united... in their losses.", "I sold my car to buy more... stability.", "My financial advisor is my cat, and even she judges me.", "The dev said 'we're different'... like all the others.", "I'm not YOLOing, I'm just making irreversible life choices.", "My portfolio is a testament to the butterfly effect.", "The chart looks like a seismograph during an earthquake... in my soul.", "I'm a diamond hand because I physically cannot click sell.", "My bags are collecting dust... and interest... negative interest.", "The only thing decentralized is my sanity.", "I'm a liquidity pool... for smart money to exit into.", "My trading strategy is 'buy high, never sell, question life'.", "The dev said 'community owned'... and promptly left the community.", "I'm not panicking, I'm just performing an emergency liquidity event.",
            "My wallet is a time capsule of financial regret.", "The chart is forming a 'existential crisis' wedge.", "I'm long on hope, short on sense.", "My bags are premium assets... according to my denial.", "The community is active... in therapy.", "I bought the top because the FOMO was stronger than the logic.", "My financial plan is 'number go up'... eventually... please.", "The dev said 'audit pending'... since the Obama administration.", "I'm not rekt, I'm just experiencing extreme value compression.", "My portfolio is a Jackson Pollock painting of red candles.", "The only thing sustainable is my inability to sell.", "I'm a crypto native... to the land of losses.", "My bags are so heavy they created a new support level... at zero.", "The community is diamond-handed... because we can't feel our fingers anymore.", "I traded my rent money for 'financial freedom'.", "My chart analysis consists of 'it looks cheap'.", "The dev said 'we're building'... a case for fraud.", "I'm not gambling, I'm just paying for expensive lessons.", "My wallet is a museum exhibit titled 'The History of Hype'.", "The chart looks like my GPA... steadily declining.", "I'm a bagholder of last resort.", "My portfolio is diversified between 'rugged' and 'about to rug'.", "The only thing bull about this market is the bullshit.", "I'm a pioneer in the field of financial self-destruction.",
            "My bags are vintage 2021... and still fermenting.", "The community is strong... like the smell of desperation.", "I bought because the logo was cute... my financial strategy.", "My financial advisor changed his identity and moved countries.", "The dev said 'HODL'... while converting to USDC.", "I'm not desperate, I'm just proactively seeking opportunity.", "My portfolio is a masterclass in sunk cost fallacy.", "The chart is forming a 'double bottom'... at the center of the earth.", "I'm leveraged on hope and collateralized by dreams.", "My bags are so heavy they qualify as hazardous materials.", "The community is engaged... in a class action lawsuit.", "I bought the dip that keeps on dipping.", "My trading strategy is 'dollar cost averaging into oblivion'.", "The dev said 'partnership announced'... with a bankruptcy lawyer.", "I'm not YOLOing, I'm just making a permanent lifestyle choice.", "My wallet is a donation address for the developer's retirement fund.", "The chart looks like a waterfall... into my empty bank account.", "I'm a long-term investor... against my will.", "My bags are collector's items... for masochists.", "The only thing decentralized is my grip on reality.", "I'm a liquidity event waiting to happen... to someone else.", "My financial plan is 'it worked for that guy on Twitter'.", "The dev said 'we're transparent'... like the air where the money went.", "I'm not coping, I'm just in the bargaining stage of grief.",
            "My portfolio is a testament to the efficient market hypothesis... being wrong.", "The chart is forming a 'descending staircase to hell' pattern.", "I'm diamond-handing... because my fingers are frozen in place.", "My bags are so heavy they have their own zip code.", "The community is tight... like a noose.", "I sold my furniture to buy more... regret.", "My chart reading skills are 'it went up before, so...'.", "The dev said 'wen lambo?'... never, apparently.", "I'm not losing money, I'm gaining experience... in poverty.", "My wallet is a graveyard of abandoned roadmaps.", "The only thing green is the envy I feel for exit liquidity.", "I'm a crypto maximalist... of pain.", "My bags are premium grade A... certified losses.", "The community is vibrant... with despair.", "I bought because the ticker symbol looked cool.", "My financial strategy is 'send it and forget it'... the money, that is.", "The dev said 'we're early'... to the rug.", "I'm not rekt, I'm just experiencing asymmetric downside.", "My portfolio is a work of abstract expressionism... titled 'Why?'", "The chart looks like my will to live... decreasing.", "I'm a hodler... because I can't find my private keys.", "My bags are legacy assets... of a legacy of bad decisions.", "The community is amazing... at creating exit liquidity for whales.", "I bought the top, held the crash, died inside.",
            "My financial advisor is a Magic 8-Ball... that filed for bankruptcy.", "The dev said 'contract renounced'... their responsibility, that is.", "I'm not desperate, I'm just aggressively seeking alpha... any alpha.", "My wallet is a black hole... for my parents' retirement fund too.", "The only thing pumping is my readiness to quit.", "I'm a bagholder... it's not a phase, mom, it's a lifestyle.", "My portfolio is a masterclass in cognitive dissonance.", "The chart is forming a 'I should have sold' flag.", "I'm leveraged on Hopium, collateralized by Copium.", "My bags are so heavy they need their own blockchain.", "The community is united... in poverty.", "I bought the dip, then averaged down, then prayed.", "My trading strategy is 'buy whatever is trending on TikTok'.", "The dev said 'we're different'... in the same way as everyone else.", "I'm not YOLOing, I'm just making irreversible allocations.", "My wallet is a donation box... for the dev's new house.", "The chart looks like a EKG flatline... of my portfolio.", "I'm a crypto enthusiast... of financial ruin.", "My bags are generational wealth... of debt.", "The community is strong... in their collective denial.", "I bought because a YouTuber with laser eyes said so.", "My financial plan is 'maybe Elon will tweet about it'.", "The dev said 'audit complete'... by their cousin.", "I'm not panicking, I'm just performing emergency capital preservation... poorly.",
            "My portfolio is a shrine to the gods of volatility.", "The only thing decentralized is my accountability.", "I'm a liquidity provider... for the dev's exit strategy.", "My bags are so heavy they broke the support line... of my will to live.", "The community is vibrant... with the energy of desperation.", "I bought the rumor, sold the news, bought the dip, became the liquidity.", "My financial advisor is a Ouija board... it just keeps spelling 'SELL'.", "The chart is forming a 'descending into madness' wedge.", "I'm not down bad, I'm up good at being rekt.", "My wallet is a time machine... taking me back to poverty.", "The dev said 'we're building'... their own exit liquidity.", "I'm a diamond hand... because my hand is stuck in a vice.", "My portfolio is a testament to the greater fool theory... and I'm the greatest fool.", "The only thing sustainable is my commitment to bad decisions.", "I'm a crypto pioneer... of new ways to lose generational wealth.", "My bags are vintage... like fine wine that turned to vinegar.", "The community is active... in trying to find the dev.", "I bought the top because gravity is just a theory.", "My trading strategy is 'buy high, sell never, inherit debt'.", "The dev said 'partnership with major brand'... their cousin's Etsy shop.", "I'm not coping, I'm just performing advanced mental resilience training.", "My wallet is a cautionary tale... that I keep adding chapters to.", "The chart looks like my credit score... after discovering leverage.", "I'm long on crypto, short on everything else... including common sense."
        ];

        const quotesElk = [
            "The antlers are heavy, but they are ours.", "We do not choose the burden, we only choose how to carry it.", "In the forest of the market, the Elk stands still.", "The herd survives not by speed, but by endurance.", "Shedding velvet is painful, but growth requires blood.", "The wilderness cares not for your wallet.", "We graze on the volatility of the world.", "To be an Elk is to carry the weight of the sky on your head.", "The clearing comes only after the thickest woods.", "Tracks in the snow fade, but the path remains.", "The mountain does not move, yet we climb it still.", "In silence, the herd finds its strength.", "The antlers are not for fighting, but for remembering.", "Winter tests the herd; only the patient survive.", "We do not run from the storm; we lower our heads and push through.", "The forest provides for those who wait.", "To migrate is to trust in the unknown.", "The old Elk knows: the grass is greener where you water it with patience.", "We are the guardians of the high places.", "The burden shared is the burden halved.", "The elk does not check the price, the elk checks the horizon.", "We carry our losses like antlers—visible, heavy, and ours alone.", "The herd moves as one shadow across the mountain.", "Even in the deepest snow, we find the grass beneath.", "The wolf fears the elk who has nothing left to lose.", "Our hooves are worn from walking the path others fear to tread.", "The elk does not ask why the mountain is high, it simply climbs.", "We are born with antlers we did not choose, but we grow them with pride.", "The silence of the forest is the only chart we trust.", "When the storm comes, the elk does not hide, it endures.", "The heaviest antlers belong to those who have survived the most winters.", "We do not fear the bear market; we have seen real bears.", "The herd remembers every path, even those grown over with doubt.", "To be an elk is to know that stillness is also a kind of movement.", "Our antlers scrape the sky so others know we are here.", "The young elk asks when the bull run comes. The old elk knows winter never ends.", "We walk uphill because that is where the clearing lies.", "The elk does not diversify its forest; it knows every tree.", "Even a broken antler points toward the sky.", "The herd sleeps standing because the market never rests.", "We do not chase the green candles; we wait for the thaw.", "The weight of the antlers reminds us we are still alive.", "The elk sees farther from the heights it has climbed alone.", "Our calls echo in valleys where liquidity has dried up.", "The strongest elk carries the scars of battles it did not start.",
            "We do not sell our winter coat when the first frost arrives.", "The forest teaches that patience outlives panic.", "An elk alone is a target; a herd together is a fortress.", "The antlers grow heavier with each passing season of survival.", "We drink from frozen streams because we refuse to move to warmer waters.", "The elk knows that the deepest snow hides the sweetest grass.", "Our tracks may wander, but our destination is always forward.", "The mountain top is lonely, but the view is worth the climb.", "We are the ghosts of the forest, carrying the weight of generations.", "The elk does not fear the dark; it was born in shadow.", "When the herd thins, the survivors grow stronger.", "Our antlers lock in combat to determine who leads through the storm.", "The elk mourns not for the leaves that fall, but prepares for the spring.", "We carry our dead with us in the strength of our stride.", "The forest floor is littered with the bones of those who ran too fast.", "To shed the old velvet is to embrace the new growth, raw and bleeding.", "The elk does not check blockfolio; it checks the barometer.", "We are the last to leave the high country when winter descends.", "The weight we carry makes our legs stronger, not weaker.", "A true elk knows that the longest night precedes the dawn.", "Our antlers are the crown we pay for with suffering.", "The herd protects its weakest because today's calf is tomorrow's leader.", "We do not panic at the first snowflake; we have seen blizzards.", "The elk's breath in cold air is proof that life persists.", "Mountains are climbed one hoof at a time, regardless of the height.", "We are the stubborn ones who refused to migrate when times got hard.", "The antlers point upward even when the head hangs low.", "In the depth of winter, the elk finds the evergreen.", "Our burden is visible so that others may learn from our endurance.",
            "The forest is indifferent, but the herd is not.", "We do not sprint to the clearing; we march with purpose.", "The old elk's antlers are worn smooth by seasons of survival.", "Even when separated by valleys, the herd thinks as one.", "The elk does not trade its horns for comfort.", "We stand in rivers not because it is easy, but because we must drink.", "The path through the thorns leads to the meadow.", "Our scars are maps of where we have been.", "The elk knows that liquidity is not just in streams, but in brotherhood.", "We carry winter in our bones so that spring feels like rebirth.", "The tallest trees were once seeds that refused to rot.", "An elk does not apologize for the space its antlers require.", "We are the ones who stayed when the fair-weather deer fled south.", "The mountain does not care about our struggles, but we climb anyway.", "Our heavy heads keep us grounded while others float away on bubbles.", "The herd's safety is worth more than individual speed.", "We grow our antlers not for decoration, but for defense against the void.", "The elk drinks from the same stream as the bear, but watches carefully.", "Winter is the true test of what was built in summer.", "We do not fear the gray sky; we were born under clouds.", "The antlers catch the first light because they reach the highest.", "To be an elk is to accept that beauty and burden grow together.", "Our footsteps crush the snow so the small ones may walk easier.", "The forest gives nothing to the elk who does not venture deep.", "We carry our weight with the dignity of those who have no choice.", "The clearing is not given; it is earned through miles of thicket.", "An elk alone trusts its antlers; a herd trusts each other.", "The longest journey is from the valley of despair to the plateau of acceptance.", "We are the antlered ones, heavy-headed and steady-hearted.",
            "In the valley of shadows, we keep our formation.", "The antler grows in the dark, unseen until the light.", "We do not fear the wolf; we fear the separation from the herd.", "The river flows regardless of our thirst.", "The snow covers our tracks, but not our journey.", "We carry the memory of the meadow in our bones.", "The bull's bugle is a prayer to the empty mountains.", "The herd moves as one mind, split across many bodies.", "We are the bridge between the earth and the sky.", "The antlers reach up while the hooves stay grounded.", "In the rut, we remember we are animals; in the herd, we remember we are family.", "The forest has no deadlines, only seasons.", "We do not own the land; we wear it.", "The highest peaks teach the deepest humility.", "To shed the antler is not to lose, but to prepare.", "The Elk does not check the price of grass.", "We are the rhythm of the hoof on stone.", "The dawn brings frost and revelation in equal measure.", "The burden is not the antler, but the forgetting of why we carry it.", "In the thicket, we find our shape.", "The herd is strongest when moving slowly.", "We drink from the stream of time.", "The mountain wind carries no news of the market.", "To be Elk is to be a cathedral of bone and patience.", "The wolves follow, but we do not run.", "The antlers cast long shadows in the setting sun.", "We are the keepers of the high valleys.", "The snow is deep, but our will is deeper.", "In the herd, no one carries the weight alone.", "The forest floor is a map written in moss and memory.", "We do not hurry the spring.", "The old bulls teach: the rut passes, the herd remains.", "To migrate is to write a letter to the future.", "The antlers are heavy because they are full of years.", "We stand in the clearing and become the clearing.", "The thunderstorm is a reminder of our smallness.", "The herd is a single beast with many hearts.", "We do not fear the winter; we are the winter's keepers.", "The path uphill is the only path.",
            "In the silence of snow, we hear our own breathing.", "The antlers are the branches we carry to remember the trees.", "To be Elk is to be a monument to endurance.", "The meadow remembers the hoof that treads lightly.", "We do not chase; we graze, we wait, we endure.", "The mountain teaches that there is no summit, only the next ridge.", "The herd's movement is a conversation in slow motion.", "We are the shadow of the forest on the snow.", "The burden makes us visible against the skyline.", "In the rutting season, we pay the price of continuity.", "The old cow knows where the water is, even when frozen.", "We do not question the weight; we distribute it.", "The antlers are the crown we never asked for.", "To be herd is to be home.", "The valley is wide, but the herd is wider.", "We carry the forest with us, even in the open field.", "The wolf howls; we lower our heads and walk on.", "The snow is our accountant; it tracks every step.", "In the depth of winter, the antler is a promise of spring.", "We are the bridge between the wild and the wise.", "The herd does not panic; it reorganizes.", "To shed is to begin again.", "The mountain does not care, but we climb it anyway.", "The antlers are heavy because they are full of light.", "We are the keepers of the quiet places.", "The burden shared becomes the burden shaped into a home.", "In the trackless waste, we make tracks.", "The Elk does not check the weather; it wears it.", "We are the rhythm between the heartbeats of the earth.", "The forest gives nothing, but offers everything.", "To migrate is to trust the memory of the body.", "The antlers reach for what the hooves cannot touch.", "We stand on the ridge and survey what is ours to endure.", "The herd is a river of brown against the white snow.", "We do not sleep; we stand watch in shifts.", "The velvet falls like leaves; the antler remains.", "To be Elk is to be a patient mountain.", "The clearing is earned, not given.", "We carry the sky on our heads so the earth can see it.", "The wolf tests the herd; the herd tests the wolf.",
            "In the rut, we remember the cost of renewal.", "The snow covers the grass but not the hunger.", "We are the architects of the alpine meadow.", "The antler is a tree that grows on the head.", "To be still is to be present.", "The herd moves like a single breath across the landscape.", "We do not fear the descent; we fear only the separation.", "The mountain wind is the voice of the ancestors.", "The burden is the blessing in disguise.", "In the thicket, we find safety in numbers.", "The Elk does not count the days; it counts the seasons.", "We are the shadow that moves against the sun.", "The antlers are the hands we raise to the sky in perpetual question.", "To graze is to pray with the mouth full.", "The herd is a democracy of survival.", "We do not hurry; the mountain waits.", "The snow is deep, but the memory of grass is deeper.", "In the valley, we are small; on the ridge, we are visible.", "The antlers are the weight that keeps us anchored to the earth.", "To be Elk is to be a library of grass and stone.", "The forest teaches that growth is vertical and horizontal.", "We carry the winter so the spring can be lighter.", "The herd is a net that catches the falling.", "We do not choose the path; the path chooses the Elk.", "The burden is not carried; it is worn like a coat.", "In the silence, the antlers speak of years.", "The mountain does not remember the Elk, but the Elk remembers the mountain.", "To migrate is to write a letter to the future.", "The antlers are the handlebars on the bicycle of survival.", "We are the punctuation marks in the sentence of the wilderness.", "The snow is the great equalizer; it covers all tracks.", "The herd survives because it moves as one doubt.", "We do not fear the night; we become the shadows.", "The clearing is a room we enter with our heads bowed.", "To be Elk is to be a continent walking.", "The antlers are the candelabra of the forest.", "We drink from streams that mirror the sky.", "The burden is the map we follow.", "In the rut, we pay the tax of existence.", "The old bull knows when to fight and when to stand still.", "We are the bridge between the grass and the stars.",
            "The herd is a single organism with distributed consciousness.", "The mountain wind carries seeds and warnings.", "To shed the antler is to let go of the year.", "We do not run from danger; we form a circle.", "The antlers are the price of admission to the high country.", "In the meadow, we are guests; in the forest, we are home.", "The snow teaches that all things are temporary except winter.", "We carry the weight so the herd can travel light.", "The Elk does not look back; the antlers prevent it.", "To graze at altitude is to dine with the clouds.", "The herd is a conspiracy of survival against the odds.", "We are the slow lightning of the mountain.", "The burden shared is the burden that shapes us.", "In the trackless snow, we write our history in hoofprints.", "The antlers are the antennae tuned to the frequency of survival.", "To be Elk is to be a philosopher with hooves.", "The forest provides the questions; the meadow provides the answers.", "We do not fear the storm; we are the storm's destination.", "The clearing is the stage; the antlers are the props.", "The herd moves like a brown river through white stone.", "We carry the memory of the herd in our muscles.", "The mountain is climbed one hoof at a time.", "To migrate is to trust in the wisdom of the body.", "The antlers are the crown of thorns that gives us presence.", "We are the guardians of the tree line.", "The snow is the blanket we cannot remove.", "In the silence of the herd, we hear everything.", "The burden is not the weight, but the fear of dropping it.", "To be Elk is to be a monument that walks.", "The forest floor is a mattress of needles and patience.", "We do not hurry the grass to grow.", "The antlers are the hands we cannot use to hold.", "The herd is a democracy where everyone votes with their feet.", "We carry the sky on our heads so it does not fall.", "The wolf is the question; the herd is the answer.", "In the rut, we remember we are mortal.", "The mountain teaches that up and down are the same direction.", "We are the shadows that stay when the sun goes.", "The antlers are the branches we save from the forest.", "To graze is to harvest sunlight secondhand.", "The herd survives not because it is fast, but because it is together.", "We do not choose the weather; we wear it like a coat.", "The clearing is earned with every step through the thicket."
        ];

        let currentMode = 'existential';
        let quoteHistory = [];

        function setMode(mode, btn) {
            currentMode = mode;
            quoteHistory = [];
            document.querySelectorAll('.mode-btn').forEach(b => {
                b.classList.remove('active');
                b.setAttribute('aria-pressed', 'false');
            });
            btn.classList.add('active');
            btn.setAttribute('aria-pressed', 'true');
            generateQuote();
        }

        function generateQuote() {
            const display = document.getElementById('quote-display');
            display.classList.remove('visible');
            setTimeout(() => {
                let pool;
                switch(currentMode) {
                    case 'existential': pool = quotesExistential; break;
                    case 'degen': pool = quotesDegen; break;
                    case 'elk': pool = quotesElk; break;
                    default: pool = quotesExistential;
                }
                
                let availableIndices = pool.map((_, i) => i).filter(i => !quoteHistory.includes(i));
                if (availableIndices.length === 0) {
                    quoteHistory = [];
                    availableIndices = pool.map((_, i) => i);
                }
                const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
                quoteHistory.push(randomIndex);
                if (quoteHistory.length > 50) quoteHistory.shift();

                display.textContent = '"' + pool[randomIndex] + '"';
                display.classList.add('visible');
            }, 300);
        }
        
        function copyQuote() {
            copyToClipboard(document.getElementById('quote-display').textContent, 'WISDOM COPIED');
        }

        // Audio Player
        const tracks = [
            { title: "Before the Clearing", file: "Before the Clearing", desc: "The silence before revelation" },
            { title: "Crimson Twilight", file: "Crimson Twilight", desc: "Day bleeds into night" },
            { title: "Echoes Where Meaning Was", file: "Echoes Where Meaning Was", desc: "Hollow chambers" },
            { title: "Eternal Weight", file: "Eternal Weight", desc: "The paradox of being" },
            { title: "Forest Depths", file: "Forest Depths", desc: "Dissolution of self" },
            { title: "Herd Gathering", file: "Herd Gathering", desc: "Many antlers, one burden" },
            { title: "Herd Through the Valley", file: "Herd Through the Valley", desc: "Moving through the low points" },
            { title: "Migration of the Burdened", file: "Migration of the Burdened", desc: "Perpetual motion" },
            { title: "Mountain Echo", file: "Mountain Echo", desc: "Voices returning to us" },
            { title: "No Elk Walks Alone", file: "No Elk Walks Alone", desc: "Solitude in numbers" },
            { title: "Signal from the Ridge", file: "Signal from the Ridge", desc: "A call to ascend" },
            { title: "The Burden", file: "The Burden", desc: "We are our weight" },
            { title: "The Herd Remembers", file: "The Herd Remembers", desc: "History carved in bone" },
            { title: "The Weight of Knowing", file: "The Weight of Knowing", desc: "Awareness is heavy" },
            { title: "Turning Ash to Altar", file: "Turning Ash to Altar", desc: "Sacred remnants" },
            { title: "What Consciousness Costs", file: "What Consciousness Costs", desc: "The price of awakening" }
        ];

        let currentTrack = 0;
        let playing = false;
        let shuffle = false;
        let repeat = false;
        let audioContext, analyser, dataArray, source;
        let isVisualizerInit = false;

        const audio = document.getElementById('audio-player');
        const imageBaseUrl = 'https://raw.githubusercontent.com/exelkonsol/elk/main/images/';
        const musicBaseUrl = 'https://raw.githubusercontent.com/exelkonsol/elk/main/music/';

        function initAudioContext() {
            if (isVisualizerInit) {
                if (audioContext && audioContext.state === 'suspended') audioContext.resume();
                return;
            }
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (!AudioContext) return;
                audioContext = new AudioContext();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = window.matchMedia('(pointer: coarse)').matches ? 128 : 256;
                source = audioContext.createMediaElementSource(audio);
                source.connect(analyser);
                analyser.connect(audioContext.destination);
                dataArray = new Uint8Array(analyser.frequencyBinCount);
                isVisualizerInit = true;
                drawVisualizer();
            } catch (e) { console.log('Audio init failed:', e); }
        }

        let visualizerId;
        function drawVisualizer() {
            const canvas = document.getElementById('visualizer-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const resize = () => {
                const rect = canvas.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;
                canvas.width = rect.width * dpr;
                canvas.height = rect.height * dpr;
                ctx.scale(dpr, dpr);
            };
            resize();
            window.addEventListener('resize', resize);
            function animate() {
                visualizerId = requestAnimationFrame(animate);
                if (!playing || !analyser) { ctx.clearRect(0, 0, canvas.width, canvas.height); return; }
                analyser.getByteFrequencyData(dataArray);
                const width = canvas.width / (window.devicePixelRatio || 1);
                const height = canvas.height / (window.devicePixelRatio || 1);
                ctx.clearRect(0, 0, width, height);
                const bars = window.matchMedia('(pointer: coarse)').matches ? 30 : 50;
                const barWidth = width / bars;
                for (let i = 0; i < bars; i++) {
                    const idx = Math.floor(i * (dataArray.length / bars));
                    const barHeight = (dataArray[idx] / 255) * height * 0.6;
                    const x = i * barWidth;
                    const y = height - barHeight;
                    const gradient = ctx.createLinearGradient(0, y, 0, height);
                    gradient.addColorStop(0, 'rgba(139, 0, 0, 0.4)');
                    gradient.addColorStop(1, 'rgba(255, 255, 255, 0.05)');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, barWidth - 2, barHeight);
                }
            }
            animate();
        }

        function initPlaylist() {
            const pl = document.getElementById('playlist');
            pl.innerHTML = '';
            tracks.forEach((t, i) => {
                const d = document.createElement('div');
                d.className = `track-item text-sm ${i === 0 ? 'active' : ''} rounded`;
                d.onclick = () => loadTrack(i, true);
                d.innerHTML = `<span class="text-white/40 truncate mr-2 font-mono text-xs flex-1">${t.title}</span><span class="text-[10px] text-white/20 shrink-0">${String(i + 1).padStart(2, '0')}</span>`;
                pl.appendChild(d);
            });
            loadTrack(0, false);
        }

        function loadTrack(idx, autoPlay = false) {
            if (idx < 0 || idx >= tracks.length) return;
            currentTrack = idx;
            const t = tracks[idx];
            document.getElementById('track-title').textContent = t.title;
            document.getElementById('track-desc').textContent = '"' + t.desc + '"';
            const artUrl = `${imageBaseUrl}${encodeURIComponent(t.file)}.png`;
            const audioUrl = `${musicBaseUrl}${encodeURIComponent(t.file)}.mp3`;
            document.getElementById('album-art-small').src = artUrl;
            document.getElementById('btn-art').src = artUrl;
            document.getElementById('audio-interface').style.backgroundImage = `url('${artUrl}')`;
            audio.src = audioUrl;
            document.querySelectorAll('.track-item').forEach((e, i) => e.classList.toggle('active', i === idx));
            audio.onloadedmetadata = () => {
                document.getElementById('time-total').textContent = fmt(audio.duration);
                if (autoPlay) playAudio();
            };
        }

        function togglePlay() {
            initAudioContext();
            if (audioContext && audioContext.state === 'suspended') audioContext.resume();
            playing ? pauseAudio() : playAudio();
        }

        function playAudio() {
            audio.play().then(() => {
                playing = true;
                document.getElementById('vinyl-disc').classList.add('playing');
                document.getElementById('mute-toggle-btn').classList.add('playing');
                document.getElementById('track-status').textContent = "Playing";
                document.getElementById('play-icon').setAttribute('data-lucide', 'pause');
                lucide.createIcons();
                if (!visualizerId) drawVisualizer();
            }).catch(e => { console.log('Playback prevented:', e); showToast('TAP TO PLAY'); });
        }

        function pauseAudio() {
            audio.pause();
            playing = false;
            document.getElementById('vinyl-disc').classList.remove('playing');
            document.getElementById('mute-toggle-btn').classList.remove('playing');
            document.getElementById('track-status').textContent = "Paused";
            document.getElementById('play-icon').setAttribute('data-lucide', 'play');
            lucide.createIcons();
        }

        function nextTrack() {
            if (shuffle) {
                let next;
                do { next = Math.floor(Math.random() * tracks.length); } while (next === currentTrack && tracks.length > 1);
                loadTrack(next, true);
            } else {
                loadTrack((currentTrack + 1) % tracks.length, true);
            }
        }

        function prevTrack() {
            if (audio.currentTime > 3) audio.currentTime = 0;
            else loadTrack((currentTrack - 1 + tracks.length) % tracks.length, true);
        }

        function toggleShuffle() {
            shuffle = !shuffle;
            document.getElementById('shuffle-btn').classList.toggle('active', shuffle);
            showToast(shuffle ? "SHUFFLE ON" : "SHUFFLE OFF");
        }

        function toggleRepeat() {
            repeat = !repeat;
            audio.loop = repeat;
            document.getElementById('repeat-btn').classList.toggle('active', repeat);
            showToast(repeat ? "REPEAT ON" : "REPEAT OFF");
        }

        function setVolume(val) { audio.volume = val / 100; }
        function fmt(s) { if (!s || !isFinite(s)) return '00:00'; const m = Math.floor(s/60), sec = Math.floor(s%60); return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`; }

        let isDragging = false;
        const progressContainer = document.getElementById('progress-container');
        function updateProgress(clientX) {
            const rect = progressContainer.getBoundingClientRect();
            const pos = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
            if (audio.duration) {
                audio.currentTime = pos * audio.duration;
                document.getElementById('progress-fill').style.width = (pos * 100) + '%';
            }
        }
        progressContainer.addEventListener('mousedown', (e) => { isDragging = true; updateProgress(e.clientX); });
        document.addEventListener('mousemove', (e) => { if (isDragging) updateProgress(e.clientX); });
        document.addEventListener('mouseup', () => { isDragging = false; });
        progressContainer.addEventListener('touchstart', (e) => { isDragging = true; updateProgress(e.touches[0].clientX); }, { passive: true });
        document.addEventListener('touchmove', (e) => { if (isDragging) updateProgress(e.touches[0].clientX); }, { passive: true });
        document.addEventListener('touchend', () => { isDragging = false; });

        audio.addEventListener('timeupdate', () => {
            if (!isDragging && audio.duration) {
                const pct = (audio.currentTime / audio.duration) * 100;
                document.getElementById('progress-fill').style.width = pct + '%';
                document.getElementById('time-current').textContent = fmt(audio.currentTime);
            }
        });
        audio.addEventListener('ended', () => { if (!repeat) nextTrack(); });

        initPlaylist();
        window.addEventListener('beforeunload', () => { if (visualizerId) cancelAnimationFrame(visualizerId); });
    </script>
</body>
</html>
